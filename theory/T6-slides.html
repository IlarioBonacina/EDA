<!DOCTYPE html>
<html lang="en"><head>
<script src="T6-slides_files/libs/clipboard/clipboard.min.js"></script>
<script src="T6-slides_files/libs/quarto-html/tabby.min.js"></script>
<script src="T6-slides_files/libs/quarto-html/popper.min.js"></script>
<script src="T6-slides_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="T6-slides_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="T6-slides_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="T6-slides_files/libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="T6-slides_files/libs/quarto-contrib/pseudocode-2.4.1/pseudocode.min.js"></script>
<link href="T6-slides_files/libs/quarto-contrib/pseudocode-2.4.1/pseudocode.min.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.39">

  <meta name="author" content="Ilario Bonacina">
  <title>EDA T6 — AVL trees and Heaps</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="T6-slides_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="T6-slides_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="T6-slides_files/libs/revealjs/dist/theme/quarto-c3320156dabefdd98dca4b9fd33cce2a.css">
  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
  <link href="T6-slides_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="T6-slides_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="T6-slides_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="T6-slides_files/libs/revealjs/plugin/reveal-attribution/attribution.css" rel="stylesheet">
  <link href="T6-slides_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script type="module" src="T6-slides_files/libs/quarto-ojs/quarto-ojs-runtime.js"></script>
  <link href="T6-slides_files/libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">EDA T6 — AVL trees and Heaps</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Ilario Bonacina 
</div>
<div class="quarto-title-author-email">
<a href="mailto:ilario.bonacina+EDA@upc.edu">ilario.bonacina+EDA@upc.edu</a>
</div>
        <p class="quarto-title-affiliation">
            This presentation is an adaptation of material from Antoni Lozano and Conrado Martinez
          </p>
    </div>
</div>

</section>
<section id="agenda" class="slide level2">
<h2>Agenda</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="last-theory-class">Last theory class</h3>
<ul>
<li>Dictionaries
<ul>
<li>Hash Tables</li>
<li>Binary Search Trees</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="fragment">
<h3 id="today">Today</h3>
<ul>
<li><p>AVL Trees</p></li>
<li><p>Heaps &amp; Priority Queues</p></li>
</ul>
</div>
</div></div>
<div class="fragment">
<p>Before we start: <span class="green"><strong>Questions on previous material?</strong></span></p>
</div>
</section>
<section>
<section id="avl-trees" class="title-slide slide level1 center">
<h1>AVL trees</h1>

</section>
<section id="binary-search-trees-recap" class="slide level2">
<h2>Binary Search Trees (recap)</h2>
<p>A <span class="def">Binary Search tree</span> (cat: <span class="def">Arbre Binari de Cerca</span>, ABC) is a binary tree such that each vertex <span class="math inline">v</span> in it has associated a key <span class="math inline">\mathsf{KEY}(v)</span> and</p>
<ul>
<li>for each vertex <span class="math inline">w</span> in the <strong>left</strong> subtree of <span class="math inline">v</span>, <span class="math inline">\mathsf{KEY}(w)&lt;\mathsf{KEY}(v)</span>,</li>
<li>for each vertex <span class="math inline">u</span> in the <strong>right</strong> subtree of <span class="math inline">v</span>, <span class="math inline">\mathsf{KEY}(u)&gt;\mathsf{KEY}(v)</span>.</li>
</ul>
<div class="fragment">
<p>We saw how to use a BST to implement a dictionary, i.e.&nbsp;how to search / insert / remove elements.</p>
</div>
<div class="fragment">
<p>For a BST of depth/height <span class="math inline">h</span> the <strong>worst-case</strong> cost of a search / insertion / deletion has cost <span class="math inline">\Theta(h)</span>.</p>
</div>
<div class="fragment">
<p><span class="alert">This is great if <span class="math inline">h\approx \log n</span> but <strong>bad</strong> when <span class="math inline">h\approx n</span> (which can happen).</span></p>
</div>
</section>
<section id="avl-trees-1" class="slide level2 scrollable">
<h2>AVL trees</h2>
<p>An <span class="def">AVL tree</span><sup>1</sup> <span class="math inline">T</span> is a binary search tree such that for every node <span class="math inline">v</span> in <span class="math inline">T</span>, let <span class="math inline">h_{\mathsf{left}}</span> and <span class="math inline">h_{\mathsf{right}}</span> be the height of the left (resp. right) sub-trees of <span class="math inline">v</span>, then <span class="math display">
\mathsf{balance}(v)=h_{\mathsf{right}}-h_{\mathsf{left}}\in \{-1,0,1\}\ .
</span></p>
<div class="fragment">
<ul>
<li>if <span class="math inline">h_{\mathsf{right}}-h_{\mathsf{left}}=1</span> we say that <span class="math inline">v</span> is <em><span class="def">right-heavy</span></em>.</li>
<li>if <span class="math inline">h_{\mathsf{right}}-h_{\mathsf{left}}=0</span> we say that <span class="math inline">v</span> is <em><span class="def">balanced</span></em>.</li>
<li>if <span class="math inline">h_{\mathsf{right}}-h_{\mathsf{left}}=-1</span> we say that <span class="math inline">v</span> is <em><span class="def">left-heavy</span></em>.</li>
</ul>
<p><br></p>
</div>
<aside><ol class="aside-footnotes"><li id="fn1"><p>AVL is the acronym of the three inventors of this data structure: the Russian computer scientists Adelson-Velskii and Landis.</p></li></ol></aside></section>
<section id="balance-factors" class="slide level2">
<h2>Balance Factors</h2>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="77" data-source-offset="-0"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 76;"><span id="cb1-77"><a href=""></a>d3 <span class="op">=</span> <span class="pp">require</span>(<span class="st">"d3-selection@1.4"</span><span class="op">,</span> <span class="st">"d3-transition@1.3"</span><span class="op">,</span> <span class="st">"d3-ease"</span><span class="op">,</span> <span class="st">"d3-interpolate"</span><span class="op">,</span> <span class="st">"d3-scale-chromatic@1.5"</span>)</span>
<span id="cb1-78"><a href=""></a>ewidth <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(width<span class="op">,</span> <span class="dv">640</span>)</span>
<span id="cb1-79"><a href=""></a>dur <span class="op">=</span> <span class="dv">2000</span></span>
<span id="cb1-80"><a href=""></a><span class="bu">root</span> <span class="op">=</span> d3<span class="op">.</span><span class="at">schemeCategory10</span>[<span class="dv">0</span>]</span>
<span id="cb1-81"><a href=""></a>pivot <span class="op">=</span> d3<span class="op">.</span><span class="at">schemeCategory10</span>[<span class="dv">1</span>]</span>
<span id="cb1-82"><a href=""></a>secondary <span class="op">=</span> d3<span class="op">.</span><span class="at">schemeCategory10</span>[<span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-6" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="86" data-source-offset="0"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 85;"><span id="cb2-86"><a href=""></a><span class="fu">html</span><span class="vs">`&lt;figure&gt;&lt;svg width=</span><span class="sc">${</span>ewidth<span class="sc">}</span><span class="vs"> height="420"&gt;</span></span>
<span id="cb2-87"><a href=""></a><span class="vs">    &lt;line class="edge" id="e54" x1="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">2</span><span class="sc">}</span><span class="vs">" y1="50" x2="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">" y2="150" stroke="black" /&gt;</span></span>
<span id="cb2-88"><a href=""></a><span class="vs">    &lt;line class="edge" id="e57" x1="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">2</span><span class="sc">}</span><span class="vs">" y1="50" x2="</span><span class="sc">${</span><span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">" y2="150" stroke="black" /&gt;</span></span>
<span id="cb2-89"><a href=""></a><span class="vs">    &lt;line class="edge" id="e42" x1="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">" y1="150" x2="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">" y2="250" stroke="black" /&gt;</span></span>
<span id="cb2-90"><a href=""></a><span class="vs">    &lt;line class="edge" id="e76" x1="</span><span class="sc">${</span><span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">" y1="150" x2="</span><span class="sc">${</span><span class="dv">5</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">" y2="250" stroke="black" /&gt;</span></span>
<span id="cb2-91"><a href=""></a><span class="vs">    &lt;line class="edge" id="e78" x1="</span><span class="sc">${</span><span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">" y1="150" x2="</span><span class="sc">${</span><span class="dv">7</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">" y2="250" stroke="black" /&gt;</span></span>
<span id="cb2-92"><a href=""></a><span class="vs">    &lt;line class="edge" id="e23" x1="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">" y1="250" x2="</span><span class="sc">${</span><span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">16</span><span class="sc">}</span><span class="vs">" y2="350" stroke="black" /&gt;</span></span>
<span id="cb2-93"><a href=""></a></span>
<span id="cb2-94"><a href=""></a><span class="vs">    &lt;g class="node" id="n5" transform="translate(</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">2</span><span class="sc">}</span><span class="vs">, 50)"&gt;</span></span>
<span id="cb2-95"><a href=""></a><span class="vs">      &lt;circle r="35" fill="white" stroke="black"&gt;&lt;/circle&gt;</span></span>
<span id="cb2-96"><a href=""></a><span class="vs">      &lt;text fill="black" text-anchor="middle" alignment-baseline="central"&gt;5&lt;/text&gt;</span></span>
<span id="cb2-97"><a href=""></a><span class="vs">      &lt;text fill="#C00" transform="translate(3, 25)" alignment-baseline="hanging"&gt;-1&lt;/text&gt;</span></span>
<span id="cb2-98"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb2-99"><a href=""></a><span class="vs">    &lt;g class="node" id="n4" transform="translate(</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">, 150)"&gt;</span></span>
<span id="cb2-100"><a href=""></a><span class="vs">      &lt;circle r="35" fill="</span><span class="sc">${</span><span class="bu">root</span><span class="sc">}</span><span class="vs">" stroke="black"&gt;&lt;/circle&gt;</span></span>
<span id="cb2-101"><a href=""></a><span class="vs">      &lt;text fill="white" text-anchor="middle" alignment-baseline="central"&gt;4&lt;/text&gt;</span></span>
<span id="cb2-102"><a href=""></a><span class="vs">      &lt;text fill="#C00" font-weight="bold" transform="translate(3, 25)" alignment-baseline="hanging"&gt;-2&lt;/text&gt;</span></span>
<span id="cb2-103"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb2-104"><a href=""></a><span class="vs">    &lt;g class="node" id="n7" transform="translate(</span><span class="sc">${</span><span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">, 150)"&gt;</span></span>
<span id="cb2-105"><a href=""></a><span class="vs">      &lt;circle r="35" fill="white" stroke="black"&gt;&lt;/circle&gt;</span></span>
<span id="cb2-106"><a href=""></a><span class="vs">      &lt;text fill="black" text-anchor="middle" alignment-baseline="central"&gt;7&lt;/text&gt;</span></span>
<span id="cb2-107"><a href=""></a><span class="vs">      &lt;text fill="#black" transform="translate(3, 25)" alignment-baseline="hanging"&gt;0&lt;/text&gt;</span></span>
<span id="cb2-108"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb2-109"><a href=""></a><span class="vs">    &lt;g class="node" id="n2" transform="translate(</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">, 250)"&gt;</span></span>
<span id="cb2-110"><a href=""></a><span class="vs">      &lt;circle r="35" fill="white" stroke="black"&gt;&lt;/circle&gt;</span></span>
<span id="cb2-111"><a href=""></a><span class="vs">      &lt;text fill="black" text-anchor="middle" alignment-baseline="central"&gt;2&lt;/text&gt;</span></span>
<span id="cb2-112"><a href=""></a><span class="vs">      &lt;text fill="#090" transform="translate(15, 20)" alignment-baseline="hanging"&gt;+1&lt;/text&gt;</span></span>
<span id="cb2-113"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb2-114"><a href=""></a><span class="vs">    &lt;g class="node" id="n6" transform="translate(</span><span class="sc">${</span><span class="dv">5</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">, 250)"&gt;</span></span>
<span id="cb2-115"><a href=""></a><span class="vs">      &lt;circle r="35" fill="white" stroke="black"&gt;&lt;/circle&gt;</span></span>
<span id="cb2-116"><a href=""></a><span class="vs">      &lt;text fill="black" text-anchor="middle" alignment-baseline="central"&gt;6&lt;/text&gt;</span></span>
<span id="cb2-117"><a href=""></a><span class="vs">      &lt;text fill="black" transform="translate(3, 25)" alignment-baseline="hanging"&gt;0&lt;/text&gt;</span></span>
<span id="cb2-118"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb2-119"><a href=""></a><span class="vs">    &lt;g class="node" id="n8" transform="translate(</span><span class="sc">${</span><span class="dv">7</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">, 250)"&gt;</span></span>
<span id="cb2-120"><a href=""></a><span class="vs">      &lt;circle r="35" fill="white" stroke="black"&gt;&lt;/circle&gt;</span></span>
<span id="cb2-121"><a href=""></a><span class="vs">      &lt;text fill="black" text-anchor="middle" alignment-baseline="central"&gt;8&lt;/text&gt;</span></span>
<span id="cb2-122"><a href=""></a><span class="vs">      &lt;text fill="black" transform="translate(3, 25)" alignment-baseline="hanging"&gt;0&lt;/text&gt;</span></span>
<span id="cb2-123"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb2-124"><a href=""></a><span class="vs">    &lt;g class="node" id="n3" transform="translate(</span><span class="sc">${</span><span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">16</span><span class="sc">}</span><span class="vs">, 350)"&gt;</span></span>
<span id="cb2-125"><a href=""></a><span class="vs">      &lt;circle r="35" fill="white" stroke="black"&gt;&lt;/circle&gt;</span></span>
<span id="cb2-126"><a href=""></a><span class="vs">      &lt;text fill="black" text-anchor="middle" alignment-baseline="central"&gt;3&lt;/text&gt;</span></span>
<span id="cb2-127"><a href=""></a><span class="vs">      &lt;text fill="black" transform="translate(3, 25)" alignment-baseline="hanging"&gt;0&lt;/text&gt;</span></span>
<span id="cb2-128"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb2-129"><a href=""></a><span class="vs">  &lt;/svg&gt;</span></span>
<span id="cb2-130"><a href=""></a><span class="vs">&lt;/figure&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="expression">

</div>
</div>
</div>
<p><span style="color: #C00">Red</span> = left-heavy<br>
<span style="color: #090">green</span> = right-heavy<br>
<strong>bold</strong> indicates where tree is too unbalanced.</p>
</section>
<section id="implementation" class="slide level2">
<h2>Implementation</h2>
<p>As for the BSTs (see last class) but in <code>Node</code> we also store the height of the node.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource cpp number-lines code-with-copy"><code class="sourceCode cpp"><span id="cb3-1"><a href=""></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> Key<span class="op">,</span> <span class="kw">typename</span> Info<span class="op">&gt;</span></span>
<span id="cb3-2"><a href=""></a><span class="kw">class</span> Dictionary <span class="op">{</span></span>
<span id="cb3-3"><a href=""></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb3-4"><a href=""></a>        <span class="kw">struct</span> Node <span class="op">{</span></span>
<span id="cb3-5"><a href=""></a>            Key key<span class="op">;</span></span>
<span id="cb3-6"><a href=""></a>            Info info<span class="op">;</span></span>
<span id="cb3-7"><a href=""></a>            Node<span class="op">*</span> left<span class="op">;</span>  <span class="co">// Pointer to left child</span></span>
<span id="cb3-8"><a href=""></a>            Node<span class="op">*</span> right<span class="op">;</span> <span class="co">// Pointer to right child</span></span>
<span id="cb3-9"><a href=""></a>            <span class="dt">int</span> height<span class="op">;</span> <span class="co">// Height of the tree</span></span>
<span id="cb3-10"><a href=""></a>            Node <span class="op">(</span><span class="at">const</span> Key<span class="op">&amp;</span> c<span class="op">,</span> <span class="at">const</span> Info<span class="op">&amp;</span> i<span class="op">,</span> Node<span class="op">*</span> l<span class="op">,</span> Node<span class="op">*</span> r<span class="op">,</span> <span class="dt">int</span> h<span class="op">)</span></span>
<span id="cb3-11"><a href=""></a>            <span class="op">:</span> key<span class="op">(</span>c<span class="op">),</span> info<span class="op">(</span>i<span class="op">),</span> left<span class="op">(</span>l<span class="op">),</span> right<span class="op">(</span>r<span class="op">),</span> height<span class="op">(</span>h<span class="op">)</span></span>
<span id="cb3-12"><a href=""></a>            <span class="op">{</span> <span class="op">}</span></span>
<span id="cb3-13"><a href=""></a>        <span class="op">};</span></span>
<span id="cb3-14"><a href=""></a>        <span class="dt">int</span> n<span class="op">;</span>  <span class="co">// Number of keys</span></span>
<span id="cb3-15"><a href=""></a>        Node<span class="op">*</span> root<span class="op">;</span> <span class="co">// Pointer to the root of the AVL</span></span>
<span id="cb3-16"><a href=""></a>        <span class="op">...</span></span>
<span id="cb3-17"><a href=""></a><span class="op">};</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>See the full implementation in the <a href="https://www.cs.upc.edu/eda/data/uploads/eda-codis.pdf#page=31">Algorismes en C++</a>.</p>
</section>
<section id="why-avl-trees" class="slide level2">
<h2>Why AVL trees?</h2>
<div>
<ul>
<li class="fragment">Every AVL tree with <span class="math inline">n</span> nodes has height <span class="math inline">\Theta(\log n)</span>.</li>
<li class="fragment">After each <strong>insertion</strong> in an AVL tree (as done for BSTs in the last class), with an extra cost of <span class="math inline">\Theta(1)</span> we can restore the tree to be an AVL.</li>
<li class="fragment">After each <strong>deletion</strong> in an AVL tree (as done for BSTs in the last class), with an extra cost of <span class="math inline">\mathcal O(\log n)</span> we can restore the tree to be an AVL.</li>
</ul>
</div>
</section>
<section id="section" class="slide level2">
<h2></h2>
<div id="thm-" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1</strong></span> Every AVL tree with <span class="math inline">n</span> nodes has height <span class="math inline">h=\Theta(\log n)</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span></p>
<div>
<ul>
<li class="fragment"><span class="math inline">h=\Omega(\log n)</span>: since AVLs trees are binary trees <span class="math inline">n\leq 2^{h+1}-1</span>.</li>
<li class="fragment"><span class="math inline">h=\mathcal O(\log n)</span>: let <span class="math inline">T(h)</span> be the smallest number of nodes in any AVL tree with height <span class="math inline">h</span>. We have that <span class="math inline">T(0)=1</span> and <span class="math inline">T(1)=2</span> and <span class="math display">
T(h)=T(h-1)+T(h-2)+1
</span></li>
</ul>
</div>
<div class="fragment">
<p>This is very similar to the recurrence for the <span class="math inline">h</span>-th Fibonacci number <span class="math inline">F_h</span>, indeed (by induction on <span class="math inline">h</span>) we can prove that <span class="math inline">T(h)=F_{h+2}-1=\Theta(\varphi^h)</span>, where <span class="math inline">\varphi=\frac{1+\sqrt{5}}{2}</span>. Since <span class="math inline">n\geq T(h)</span>, we get <span class="math inline">n=\mathcal O(\log n)</span>.</p>
</div>
</div>
</section>
<section id="search-in-an-avl" class="slide level2">
<h2>Search in an AVL</h2>
<p>This is done as in any other BST (see last class).</p>
<p><br></p>
<p>By the previous theorem, the cost of any search for a key in an AVL tree of size <span class="math inline">n</span> is <span class="math inline">O(\log n)</span>, even in the worst case.</p>
</section>
<section id="insertion-in-an-avl" class="slide level2">
<h2>Insertion in an AVL</h2>
<p>Insertion in an AVL tree at first is done as for generic BSTs, but this might invalidate the balance of some nodes.</p>
<div class="fragment">
<p><span class="question">What numbers could be the out-of-bounds balance?</span></p>
</div>
<div class="fragment">
<p><span class="question">Where could be in the tree the nodes with out-of-bounds balance?</span></p>
</div>
<div class="fragment">
<p><span class="question">How could we restore the balance efficiently?</span></p>
</div>
<div class="fragment">
<p>If the balance condition at some node is not valid anymore (it can only become <span class="math inline">+2</span> or <span class="math inline">-2</span>) we must do something to fix it and re-establish the invariant. This is done via <em>left</em> and <em>right</em> rotations (or combinations of them).</p>
</div>
</section>
<section id="the-magic-of-avl-trees" class="slide level2">
<h2>The “<em>magic</em>” of AVL trees</h2>
<p>After the <strong>insertion</strong> of a vertex in an AVL tree, at most 2 rotations are enough to re-establish the balances <strong>on every vertex</strong>.</p>
<p><em>root</em> = the deepest vertex not respecting the balance condition before any rotation</p>
<p><em>pivot</em> = its child along the path towards the new vertex added</p>
<p>We have 4 possibilities:</p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">root</th>
<th style="text-align: center;">pivot</th>
<th style="text-align: center;">short name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">balance</td>
<td style="text-align: center;">+2</td>
<td style="text-align: center;">+1 or 0</td>
<td style="text-align: center;">RR</td>
</tr>
<tr class="even">
<td style="text-align: center;">balance</td>
<td style="text-align: center;">+2</td>
<td style="text-align: center;">-1</td>
<td style="text-align: center;">RL</td>
</tr>
<tr class="odd">
<td style="text-align: center;">balance</td>
<td style="text-align: center;">-2</td>
<td style="text-align: center;">-1</td>
<td style="text-align: center;">LL</td>
</tr>
<tr class="even">
<td style="text-align: center;">balance</td>
<td style="text-align: center;">-2</td>
<td style="text-align: center;">+1 or 0</td>
<td style="text-align: center;">LR</td>
</tr>
</tbody>
</table>
</section>
<section id="ll-case" class="slide level2">
<h2>LL case</h2>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="243" data-source-offset="0"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 242;"><span id="cb4-243"><a href=""></a>{</span>
<span id="cb4-244"><a href=""></a>  <span class="kw">const</span> view <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;figure&gt;&lt;svg width=</span><span class="sc">${</span>ewidth<span class="sc">}</span><span class="vs"> height="452"&gt;</span></span>
<span id="cb4-245"><a href=""></a><span class="vs">    &lt;line class="edge" id="e12" x1="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">2</span><span class="sc">}</span><span class="vs">" y1="50" x2="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">" y2="150" stroke="black" /&gt;</span></span>
<span id="cb4-246"><a href=""></a><span class="vs">    &lt;line class="edge" id="e13" x1="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">2</span><span class="sc">}</span><span class="vs">" y1="50" x2="</span><span class="sc">${</span><span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">" y2="150" stroke="black" /&gt;</span></span>
<span id="cb4-247"><a href=""></a><span class="vs">    &lt;line class="edge" id="e24" x1="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">" y1="150" x2="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">" y2="250" stroke="black" /&gt;</span></span>
<span id="cb4-248"><a href=""></a><span class="vs">    &lt;line class="edge" id="e25" x1="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">" y1="150" x2="</span><span class="sc">${</span><span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">" y2="250" stroke="black" /&gt;</span></span>
<span id="cb4-249"><a href=""></a></span>
<span id="cb4-250"><a href=""></a><span class="vs">    &lt;g class="node" id="n1" transform="translate(</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">2</span><span class="sc">}</span><span class="vs">, 50)"&gt;</span></span>
<span id="cb4-251"><a href=""></a><span class="vs">      &lt;circle r="35" fill="</span><span class="sc">${</span><span class="bu">root</span><span class="sc">}</span><span class="vs">" stroke="black"&gt;&lt;/circle&gt;</span></span>
<span id="cb4-252"><a href=""></a><span class="vs">      &lt;text class="value" fill="white" text-anchor="middle" alignment-baseline="central"&gt;root&lt;/text&gt;</span></span>
<span id="cb4-253"><a href=""></a><span class="vs">      &lt;text class="balance" fill="#C00" transform="translate(3, 25)" alignment-baseline="hanging" style="font-weight:bold"&gt;-2&lt;/text&gt;</span></span>
<span id="cb4-254"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb4-255"><a href=""></a><span class="vs">    &lt;g class="node" id="n2" transform="translate(</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">, 150)"&gt;</span></span>
<span id="cb4-256"><a href=""></a><span class="vs">      &lt;circle r="35" fill="</span><span class="sc">${</span>pivot<span class="sc">}</span><span class="vs">" stroke="black"&gt;&lt;/circle&gt;</span></span>
<span id="cb4-257"><a href=""></a><span class="vs">      &lt;text class="value" fill="white" text-anchor="middle" alignment-baseline="central"&gt;pivot&lt;/text&gt;</span></span>
<span id="cb4-258"><a href=""></a><span class="vs">      &lt;text class="balance" fill="#C00" transform="translate(3, 25)" alignment-baseline="hanging"&gt;-1&lt;/text&gt;</span></span>
<span id="cb4-259"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb4-260"><a href=""></a><span class="vs">    &lt;g class="node" id="n3" transform="translate(</span><span class="sc">${</span><span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">, 150)"&gt;</span></span>
<span id="cb4-261"><a href=""></a><span class="vs">      &lt;polygon points="0, 0 25, 100 -25, 100" fill="white" stroke="black" /&gt;</span></span>
<span id="cb4-262"><a href=""></a><span class="vs">      &lt;text fill="black" y="50" text-anchor="middle" alignment-baseline="central"&gt;h&lt;/text&gt;</span></span>
<span id="cb4-263"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb4-264"><a href=""></a><span class="vs">    &lt;g class="node" id="n4" transform="translate(</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">, 250)"&gt;</span></span>
<span id="cb4-265"><a href=""></a><span class="vs">      &lt;polygon points="0, 0 25, 100 -25, 100" fill="white" stroke="black" /&gt;</span></span>
<span id="cb4-266"><a href=""></a><span class="vs">      &lt;text fill="black" y="50" text-anchor="middle" alignment-baseline="central"&gt;h&lt;/text&gt;</span></span>
<span id="cb4-267"><a href=""></a><span class="vs">      &lt;line x1="0" y1="100" x2="0" y2="175" stroke="black" stroke-dasharray="4" /&gt;</span></span>
<span id="cb4-268"><a href=""></a><span class="vs">      &lt;circle cy="175" r="10" stroke-dasharray="4" fill="white" stroke="black"&gt;&lt;/circle&gt;</span></span>
<span id="cb4-269"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb4-270"><a href=""></a><span class="vs">    &lt;g class="node" id="n5" transform="translate(</span><span class="sc">${</span><span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">, 250)"&gt;</span></span>
<span id="cb4-271"><a href=""></a><span class="vs">      &lt;polygon points="0, 0 25, 100 -25, 100" fill="white" stroke="black" /&gt;</span></span>
<span id="cb4-272"><a href=""></a><span class="vs">      &lt;text fill="black" y="50" text-anchor="middle" alignment-baseline="central"&gt;h&lt;/text&gt;</span></span>
<span id="cb4-273"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb4-274"><a href=""></a><span class="vs"> &lt;/svg&gt;</span></span>
<span id="cb4-275"><a href=""></a><span class="vs">&lt;/figure&gt;`</span><span class="op">;</span></span>
<span id="cb4-276"><a href=""></a>  </span>
<span id="cb4-277"><a href=""></a>  <span class="kw">const</span> tree_view <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(view)<span class="op">;</span></span>
<span id="cb4-278"><a href=""></a>  <span class="kw">var</span> t <span class="op">=</span> d3<span class="op">.</span><span class="fu">transition</span>()<span class="op">;</span></span>
<span id="cb4-279"><a href=""></a>  </span>
<span id="cb4-280"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#e12"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb4-281"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb4-282"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb4-283"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb4-284"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb4-285"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb4-286"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb4-287"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb4-288"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">50</span>)</span>
<span id="cb4-289"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-290"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-291"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb4-292"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb4-293"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">50</span>)</span>
<span id="cb4-294"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb4-295"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb4-296"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-297"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-298"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb4-299"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb4-300"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#e13"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb4-301"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb4-302"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb4-303"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb4-304"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb4-305"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb4-306"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb4-307"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">7</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>)</span>
<span id="cb4-308"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">250</span>)</span>
<span id="cb4-309"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-310"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-311"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb4-312"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb4-313"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">50</span>)</span>
<span id="cb4-314"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb4-315"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb4-316"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-317"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-318"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb4-319"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb4-320"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#e24"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb4-321"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb4-322"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb4-323"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb4-324"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb4-325"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb4-326"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">50</span>)</span>
<span id="cb4-327"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb4-328"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb4-329"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-330"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-331"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb4-332"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb4-333"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb4-334"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">8</span>)</span>
<span id="cb4-335"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">250</span>)</span>
<span id="cb4-336"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-337"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-338"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb4-339"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb4-340"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#e25"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb4-341"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb4-342"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb4-343"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb4-344"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb4-345"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb4-346"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb4-347"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">5</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>)</span>
<span id="cb4-348"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">250</span>)</span>
<span id="cb4-349"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-350"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-351"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb4-352"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb4-353"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb4-354"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>)</span>
<span id="cb4-355"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">250</span>)</span>
<span id="cb4-356"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-357"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-358"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb4-359"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb4-360"><a href=""></a></span>
<span id="cb4-361"><a href=""></a>  </span>
<span id="cb4-362"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n1"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb4-363"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb4-364"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb4-365"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb4-366"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb4-367"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (<span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span>) <span class="op">+</span> <span class="st">", 150)"</span>)</span>
<span id="cb4-368"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-369"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-370"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb4-371"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (ewidth<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span> <span class="st">", 50)"</span>)</span>
<span id="cb4-372"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-373"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-374"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb4-375"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb4-376"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n1&gt;.balance"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb4-377"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb4-378"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb4-379"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb4-380"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb4-381"><a href=""></a>          <span class="op">.</span><span class="fu">textTween</span>(() <span class="kw">=&gt;</span> ((t) <span class="kw">=&gt;</span> t <span class="op">&lt;=</span> <span class="fl">0.5</span> <span class="op">?</span> <span class="st">"-2"</span> <span class="op">:</span> <span class="st">"0"</span>))</span>
<span id="cb4-382"><a href=""></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)</span>
<span id="cb4-383"><a href=""></a>          <span class="op">.</span><span class="fu">styleTween</span>(<span class="st">"font-weight"</span><span class="op">,</span> () <span class="kw">=&gt;</span> ((t) <span class="kw">=&gt;</span> t <span class="op">&lt;=</span> <span class="fl">0.5</span> <span class="op">?</span> <span class="st">"bold"</span> <span class="op">:</span><span class="st">"normal"</span>))</span>
<span id="cb4-384"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-385"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-386"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb4-387"><a href=""></a>          <span class="op">.</span><span class="fu">text</span>(<span class="op">-</span><span class="dv">2</span>)</span>
<span id="cb4-388"><a href=""></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#c00"</span>)</span>
<span id="cb4-389"><a href=""></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="st">"bold"</span>)</span>
<span id="cb4-390"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-391"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-392"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb4-393"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb4-394"><a href=""></a>  </span>
<span id="cb4-395"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n2"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb4-396"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb4-397"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb4-398"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb4-399"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb4-400"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (ewidth<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span> <span class="st">", 50)"</span>)</span>
<span id="cb4-401"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-402"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-403"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb4-404"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (ewidth<span class="op">/</span><span class="dv">4</span>) <span class="op">+</span> <span class="st">", 150)"</span>)</span>
<span id="cb4-405"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-406"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-407"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb4-408"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb4-409"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n2&gt;.balance"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb4-410"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb4-411"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb4-412"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb4-413"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb4-414"><a href=""></a>          <span class="op">.</span><span class="fu">textTween</span>(() <span class="kw">=&gt;</span> ((t) <span class="kw">=&gt;</span> t <span class="op">&lt;=</span> <span class="fl">0.5</span> <span class="op">?</span> <span class="st">"-1"</span> <span class="op">:</span> <span class="st">"0"</span>))</span>
<span id="cb4-415"><a href=""></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)</span>
<span id="cb4-416"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-417"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-418"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb4-419"><a href=""></a>          <span class="op">.</span><span class="fu">text</span>(<span class="st">"-1"</span>)</span>
<span id="cb4-420"><a href=""></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#c00"</span>)</span>
<span id="cb4-421"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-422"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-423"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb4-424"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb4-425"><a href=""></a></span>
<span id="cb4-426"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n3"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb4-427"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb4-428"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb4-429"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb4-430"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb4-431"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (<span class="dv">7</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>) <span class="op">+</span> <span class="st">", 250)"</span>)</span>
<span id="cb4-432"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-433"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-434"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb4-435"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (<span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span>) <span class="op">+</span> <span class="st">", 150)"</span>)</span>
<span id="cb4-436"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-437"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-438"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb4-439"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb4-440"><a href=""></a></span>
<span id="cb4-441"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n4"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb4-442"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb4-443"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb4-444"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb4-445"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb4-446"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (ewidth<span class="op">/</span><span class="dv">4</span>) <span class="op">+</span> <span class="st">", 150)"</span>)</span>
<span id="cb4-447"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-448"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-449"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb4-450"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (ewidth<span class="op">/</span><span class="dv">8</span>) <span class="op">+</span> <span class="st">", 250)"</span>)</span>
<span id="cb4-451"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-452"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-453"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb4-454"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb4-455"><a href=""></a></span>
<span id="cb4-456"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n5"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb4-457"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb4-458"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb4-459"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb4-460"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb4-461"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (<span class="dv">5</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>) <span class="op">+</span> <span class="st">", 250)"</span>)</span>
<span id="cb4-462"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-463"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-464"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb4-465"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (<span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>) <span class="op">+</span> <span class="st">", 250)"</span>)</span>
<span id="cb4-466"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb4-467"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb4-468"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb4-469"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb4-470"><a href=""></a>  </span>
<span id="cb4-471"><a href=""></a>  <span class="cf">return</span> view<span class="op">;</span></span>
<span id="cb4-472"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="expression">

</div>
</div>
</div>
<!--
:::{.absolute top=50 left=650}
This type of rotation is also sometimes called [LL]{.def} (left-left), since the root and the pivot are both left heavy.
:::
-->
<p>Balance Factors before &amp; after a single right rotation<br>
The dotted lines denote the new vertex added.</p>

<aside><div>
<p><strong>Credits</strong>: the animations of the rotations are from <a href="https://observablehq.com/@infowantstobeseen/avl-trees-understanding-rotations">this blog-post</a> on understanding AVL rotations.</p>
</div></aside></section>
<section id="implementation-of-an-ll-rotation" class="slide level2">
<h2>Implementation of an LL rotation</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource cpp number-lines code-with-copy"><code class="sourceCode cpp"><span id="cb5-1"><a href=""></a><span class="at">static</span> <span class="dt">void</span> update_height <span class="op">(</span>Node<span class="op">*</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-2"><a href=""></a>    p<span class="op">-&gt;</span>height <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> max<span class="op">(</span>height<span class="op">(</span>p<span class="op">-&gt;</span>left<span class="op">),</span> height<span class="op">(</span>p<span class="op">-&gt;</span>right<span class="op">));</span></span>
<span id="cb5-3"><a href=""></a><span class="op">}</span></span>
<span id="cb5-4"><a href=""></a></span>
<span id="cb5-5"><a href=""></a><span class="at">static</span> <span class="dt">void</span> LL <span class="op">(</span>Node<span class="op">*&amp;</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-6"><a href=""></a>    Node<span class="op">*</span> q <span class="op">=</span> p<span class="op">;</span></span>
<span id="cb5-7"><a href=""></a>    p <span class="op">=</span> p<span class="op">-&gt;</span>left<span class="op">;</span></span>
<span id="cb5-8"><a href=""></a>    q<span class="op">-&gt;</span>left <span class="op">=</span> p<span class="op">-&gt;</span>right<span class="op">;</span></span>
<span id="cb5-9"><a href=""></a>    p<span class="op">-&gt;</span>right <span class="op">=</span> q<span class="op">;</span></span>
<span id="cb5-10"><a href=""></a>    update_height<span class="op">(</span>q<span class="op">);</span></span>
<span id="cb5-11"><a href=""></a>    update_height<span class="op">(</span>p<span class="op">);</span></span>
<span id="cb5-12"><a href=""></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>LL rotations are not expensive: just change a couple of pointers.</p>
</section>
<section id="ll-rotations-correctness" class="slide level2">
<h2>LL rotations — <em>correctness</em></h2>
<p><img data-src="assets/right-rotation-pre.png" style="width:40.0%"> <img data-src="assets/right-rotation-post.png" style="width:40.0%"></p>
<ul>
<li>LL rotations preserve the BST properties of the tree (<span class="alert">check!</span>)</li>
<li>LL rotations fix the unbalance (in the LL case) (<span class="alert">check!</span>)</li>
</ul>
</section>
<section id="rr-case" class="slide level2">
<h2>RR case</h2>
<p>The RR case (both root and pivot right heavy) is symmetric w.r.t. the LL case</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="522" data-source-offset="0"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 521;"><span id="cb6-522"><a href=""></a>{</span>
<span id="cb6-523"><a href=""></a>  <span class="kw">const</span> view <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;figure&gt;&lt;svg width=</span><span class="sc">${</span>ewidth<span class="sc">}</span><span class="vs"> height="452"&gt;</span></span>
<span id="cb6-524"><a href=""></a><span class="vs">    &lt;line class="edge" id="e12" x1="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">2</span><span class="sc">}</span><span class="vs">" y1="50" x2="</span><span class="sc">${</span><span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">" y2="150" stroke="black" /&gt;</span></span>
<span id="cb6-525"><a href=""></a><span class="vs">    &lt;line class="edge" id="e13" x1="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">2</span><span class="sc">}</span><span class="vs">" y1="50" x2="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">" y2="150" stroke="black" /&gt;</span></span>
<span id="cb6-526"><a href=""></a><span class="vs">    &lt;line class="edge" id="e24" x1="</span><span class="sc">${</span><span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">" y1="150" x2="</span><span class="sc">${</span><span class="dv">7</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">" y2="250" stroke="black" /&gt;</span></span>
<span id="cb6-527"><a href=""></a><span class="vs">    &lt;line class="edge" id="e25" x1="</span><span class="sc">${</span><span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">" y1="150" x2="</span><span class="sc">${</span><span class="dv">5</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">" y2="250" stroke="black" /&gt;</span></span>
<span id="cb6-528"><a href=""></a></span>
<span id="cb6-529"><a href=""></a><span class="vs">    &lt;g class="node" id="n1" transform="translate(</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">2</span><span class="sc">}</span><span class="vs">, 50)"&gt;</span></span>
<span id="cb6-530"><a href=""></a><span class="vs">      &lt;circle r="35" fill="</span><span class="sc">${</span><span class="bu">root</span><span class="sc">}</span><span class="vs">" stroke="black"&gt;&lt;/circle&gt;</span></span>
<span id="cb6-531"><a href=""></a><span class="vs">      &lt;text class="value" fill="white" text-anchor="middle" alignment-baseline="central"&gt;root&lt;/text&gt;</span></span>
<span id="cb6-532"><a href=""></a><span class="vs">      &lt;text class="balance" fill="#090" transform="translate(3, 25)" alignment-baseline="hanging" style="font-weight:bold"&gt;+2&lt;/text&gt;</span></span>
<span id="cb6-533"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb6-534"><a href=""></a><span class="vs">    &lt;g class="node" id="n2" transform="translate(</span><span class="sc">${</span><span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">, 150)"&gt;</span></span>
<span id="cb6-535"><a href=""></a><span class="vs">      &lt;circle r="35" fill="</span><span class="sc">${</span>pivot<span class="sc">}</span><span class="vs">" stroke="black"&gt;&lt;/circle&gt;</span></span>
<span id="cb6-536"><a href=""></a><span class="vs">      &lt;text class="value" fill="white" text-anchor="middle" alignment-baseline="central"&gt;pivot&lt;/text&gt;</span></span>
<span id="cb6-537"><a href=""></a><span class="vs">      &lt;text class="balance" fill="#090" transform="translate(3, 25)" alignment-baseline="hanging"&gt;+1&lt;/text&gt;</span></span>
<span id="cb6-538"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb6-539"><a href=""></a><span class="vs">    &lt;g class="node" id="n3" transform="translate(</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">, 150)"&gt;</span></span>
<span id="cb6-540"><a href=""></a><span class="vs">      &lt;polygon points="0, 0 25, 100 -25, 100" fill="white" stroke="black" /&gt;</span></span>
<span id="cb6-541"><a href=""></a><span class="vs">      &lt;text fill="black" y="50" text-anchor="middle" alignment-baseline="central"&gt;h&lt;/text&gt;</span></span>
<span id="cb6-542"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb6-543"><a href=""></a><span class="vs">    &lt;g class="node" id="n4" transform="translate(</span><span class="sc">${</span><span class="dv">7</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">, 250)"&gt;</span></span>
<span id="cb6-544"><a href=""></a><span class="vs">      &lt;polygon points="0, 0 25, 100 -25, 100" fill="white" stroke="black" /&gt;</span></span>
<span id="cb6-545"><a href=""></a><span class="vs">      &lt;text fill="black" y="50" text-anchor="middle" alignment-baseline="central"&gt;h&lt;/text&gt;</span></span>
<span id="cb6-546"><a href=""></a><span class="vs">      &lt;line x1="0" y1="100" x2="0" y2="175" stroke="black" stroke-dasharray="4" /&gt;</span></span>
<span id="cb6-547"><a href=""></a><span class="vs">      &lt;circle cy="175" r="10" stroke-dasharray="4" fill="white" stroke="black"&gt;&lt;/circle&gt;</span></span>
<span id="cb6-548"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb6-549"><a href=""></a><span class="vs">    &lt;g class="node" id="n5" transform="translate(</span><span class="sc">${</span><span class="dv">5</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">, 250)"&gt;</span></span>
<span id="cb6-550"><a href=""></a><span class="vs">      &lt;polygon points="0, 0 25, 100 -25, 100" fill="white" stroke="black" /&gt;</span></span>
<span id="cb6-551"><a href=""></a><span class="vs">      &lt;text fill="black" y="50" text-anchor="middle" alignment-baseline="central"&gt;h&lt;/text&gt;</span></span>
<span id="cb6-552"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb6-553"><a href=""></a><span class="vs"> &lt;/svg&gt;</span></span>
<span id="cb6-554"><a href=""></a><span class="vs">  &lt;/figure&gt;`</span><span class="op">;</span></span>
<span id="cb6-555"><a href=""></a>  </span>
<span id="cb6-556"><a href=""></a>  <span class="kw">const</span> tree_view <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(view)<span class="op">;</span></span>
<span id="cb6-557"><a href=""></a>  <span class="kw">var</span> t <span class="op">=</span> d3<span class="op">.</span><span class="fu">transition</span>()<span class="op">;</span></span>
<span id="cb6-558"><a href=""></a>  </span>
<span id="cb6-559"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#e12"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb6-560"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb6-561"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb6-562"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb6-563"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb6-564"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb6-565"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb6-566"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb6-567"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">50</span>)</span>
<span id="cb6-568"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-569"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-570"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb6-571"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb6-572"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">50</span>)</span>
<span id="cb6-573"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb6-574"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb6-575"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-576"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-577"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb6-578"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb6-579"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#e13"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb6-580"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb6-581"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb6-582"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb6-583"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb6-584"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb6-585"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb6-586"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">8</span>)</span>
<span id="cb6-587"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">250</span>)</span>
<span id="cb6-588"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-589"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-590"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb6-591"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb6-592"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">50</span>)</span>
<span id="cb6-593"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb6-594"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb6-595"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-596"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-597"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb6-598"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb6-599"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#e24"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb6-600"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb6-601"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb6-602"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb6-603"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb6-604"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb6-605"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">50</span>)</span>
<span id="cb6-606"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb6-607"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb6-608"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-609"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-610"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb6-611"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb6-612"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb6-613"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">7</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>)</span>
<span id="cb6-614"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">250</span>)</span>
<span id="cb6-615"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-616"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-617"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb6-618"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb6-619"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#e25"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb6-620"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb6-621"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb6-622"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb6-623"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb6-624"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb6-625"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb6-626"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>)</span>
<span id="cb6-627"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">250</span>)</span>
<span id="cb6-628"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-629"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-630"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb6-631"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb6-632"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb6-633"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">5</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>)</span>
<span id="cb6-634"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">250</span>)</span>
<span id="cb6-635"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-636"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-637"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb6-638"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb6-639"><a href=""></a></span>
<span id="cb6-640"><a href=""></a>  </span>
<span id="cb6-641"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n1"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb6-642"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb6-643"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb6-644"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb6-645"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb6-646"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (ewidth<span class="op">/</span><span class="dv">4</span>) <span class="op">+</span> <span class="st">", 150)"</span>)</span>
<span id="cb6-647"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-648"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-649"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb6-650"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (ewidth<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span> <span class="st">", 50)"</span>)</span>
<span id="cb6-651"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-652"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-653"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb6-654"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb6-655"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n1&gt;.balance"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb6-656"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb6-657"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb6-658"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb6-659"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb6-660"><a href=""></a>          <span class="op">.</span><span class="fu">textTween</span>(() <span class="kw">=&gt;</span> ((t) <span class="kw">=&gt;</span> t <span class="op">&lt;=</span> <span class="fl">0.5</span> <span class="op">?</span> <span class="st">"+2"</span> <span class="op">:</span> <span class="st">"0"</span>))</span>
<span id="cb6-661"><a href=""></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)</span>
<span id="cb6-662"><a href=""></a>          <span class="op">.</span><span class="fu">styleTween</span>(<span class="st">"font-weight"</span><span class="op">,</span> () <span class="kw">=&gt;</span> ((t) <span class="kw">=&gt;</span> t <span class="op">&lt;=</span> <span class="fl">0.5</span> <span class="op">?</span> <span class="st">"bold"</span> <span class="op">:</span><span class="st">"normal"</span>))</span>
<span id="cb6-663"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-664"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-665"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb6-666"><a href=""></a>          <span class="op">.</span><span class="fu">text</span>(<span class="st">"+2"</span>)</span>
<span id="cb6-667"><a href=""></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#090"</span>)</span>
<span id="cb6-668"><a href=""></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="st">"bold"</span>)</span>
<span id="cb6-669"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-670"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-671"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb6-672"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb6-673"><a href=""></a>  </span>
<span id="cb6-674"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n2"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb6-675"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb6-676"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb6-677"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb6-678"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb6-679"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (ewidth<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span> <span class="st">", 50)"</span>)</span>
<span id="cb6-680"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-681"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-682"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb6-683"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (<span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span>) <span class="op">+</span> <span class="st">", 150)"</span>)</span>
<span id="cb6-684"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-685"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-686"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb6-687"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb6-688"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n2&gt;.balance"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb6-689"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb6-690"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb6-691"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb6-692"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb6-693"><a href=""></a>          <span class="op">.</span><span class="fu">textTween</span>(() <span class="kw">=&gt;</span> ((t) <span class="kw">=&gt;</span> t <span class="op">&lt;=</span> <span class="fl">0.5</span> <span class="op">?</span> <span class="st">"+1"</span> <span class="op">:</span> <span class="st">"0"</span>))</span>
<span id="cb6-694"><a href=""></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)</span>
<span id="cb6-695"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-696"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-697"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb6-698"><a href=""></a>          <span class="op">.</span><span class="fu">text</span>(<span class="st">"+1"</span>)</span>
<span id="cb6-699"><a href=""></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#090"</span>)</span>
<span id="cb6-700"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-701"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-702"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb6-703"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb6-704"><a href=""></a></span>
<span id="cb6-705"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n3"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb6-706"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb6-707"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb6-708"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb6-709"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb6-710"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> ( ewidth<span class="op">/</span><span class="dv">8</span>) <span class="op">+</span> <span class="st">", 250)"</span>)</span>
<span id="cb6-711"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-712"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-713"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb6-714"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (ewidth<span class="op">/</span><span class="dv">4</span>) <span class="op">+</span> <span class="st">", 150)"</span>)</span>
<span id="cb6-715"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-716"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-717"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb6-718"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb6-719"><a href=""></a></span>
<span id="cb6-720"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n4"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb6-721"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb6-722"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb6-723"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb6-724"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb6-725"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (<span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span>) <span class="op">+</span> <span class="st">", 150)"</span>)</span>
<span id="cb6-726"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-727"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-728"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb6-729"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (<span class="dv">7</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>) <span class="op">+</span> <span class="st">", 250)"</span>)</span>
<span id="cb6-730"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-731"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-732"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb6-733"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb6-734"><a href=""></a></span>
<span id="cb6-735"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n5"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb6-736"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb6-737"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb6-738"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb6-739"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb6-740"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (<span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>) <span class="op">+</span> <span class="st">", 250)"</span>)</span>
<span id="cb6-741"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-742"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-743"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb6-744"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (<span class="dv">5</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>) <span class="op">+</span> <span class="st">", 250)"</span>)</span>
<span id="cb6-745"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb6-746"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb6-747"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb6-748"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb6-749"><a href=""></a>  </span>
<span id="cb6-750"><a href=""></a>  <span class="cf">return</span> view<span class="op">;</span></span>
<span id="cb6-751"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="expression">

</div>
</div>
</div>

<div class="absolute" style="top: 150px; left: 650px; ">
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource cpp number-lines code-with-copy"><code class="sourceCode cpp"><span id="cb7-1"><a href=""></a><span class="at">static</span> <span class="dt">void</span> RR <span class="op">(</span>Node<span class="op">*&amp;</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-2"><a href=""></a>    Node<span class="op">*</span> q <span class="op">=</span> p<span class="op">;</span></span>
<span id="cb7-3"><a href=""></a>    p <span class="op">=</span> p<span class="op">-&gt;</span>right<span class="op">;</span></span>
<span id="cb7-4"><a href=""></a>    q<span class="op">-&gt;</span>right <span class="op">=</span> p<span class="op">-&gt;</span>left<span class="op">;</span></span>
<span id="cb7-5"><a href=""></a>    p<span class="op">-&gt;</span>left <span class="op">=</span> q<span class="op">;</span></span>
<span id="cb7-6"><a href=""></a>    update_height<span class="op">(</span>q<span class="op">);</span></span>
<span id="cb7-7"><a href=""></a>    update_height<span class="op">(</span>p<span class="op">);</span></span>
<span id="cb7-8"><a href=""></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>As for LL rotations, RR rotations can also be done essentially changing a couple of pointers.</p>
</div>
<aside><div>
<p><strong>Credits</strong>: the animations of the rotations are from <a href="https://observablehq.com/@infowantstobeseen/avl-trees-understanding-rotations">this blog-post</a> on understanding AVL rotations.</p>
</div></aside></section>
<section id="lr-case" class="slide level2">
<h2>LR case</h2>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="777" data-source-offset="0"><pre class="sourceCode numberSource js number-lines code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 776;"><span id="cb8-777"><a href=""></a>{</span>
<span id="cb8-778"><a href=""></a>  <span class="kw">const</span> view <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;figure style="transform: scale(0.7);"&gt;&lt;svg width=</span><span class="sc">${</span>ewidth<span class="sc">}</span><span class="vs"> height="552"&gt;</span></span>
<span id="cb8-779"><a href=""></a></span>
<span id="cb8-780"><a href=""></a><span class="vs">    &lt;line class="edge" id="e12" x1="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">2</span><span class="sc">}</span><span class="vs">" y1="50" x2="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">" y2="150" stroke="black" /&gt;</span></span>
<span id="cb8-781"><a href=""></a><span class="vs">    &lt;line class="edge" id="e13" x1="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">2</span><span class="sc">}</span><span class="vs">" y1="50" x2="</span><span class="sc">${</span><span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">" y2="150" stroke="black" /&gt;</span></span>
<span id="cb8-782"><a href=""></a><span class="vs">    &lt;line class="edge" id="e24" x1="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">" y1="150" x2="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">" y2="250" stroke="black" /&gt;</span></span>
<span id="cb8-783"><a href=""></a><span class="vs">    &lt;line class="edge" id="e25" x1="</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">" y1="150" x2="</span><span class="sc">${</span><span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">" y2="250" stroke="black" /&gt;</span></span>
<span id="cb8-784"><a href=""></a><span class="vs">    &lt;line class="edge" id="e510" x1="</span><span class="sc">${</span><span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">" y1="250" x2="</span><span class="sc">${</span><span class="dv">5</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">16</span><span class="sc">}</span><span class="vs">" y2="350" stroke="black" /&gt;</span></span>
<span id="cb8-785"><a href=""></a><span class="vs">    &lt;line class="edge" id="e511" x1="</span><span class="sc">${</span><span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">" y1="250" x2="</span><span class="sc">${</span><span class="dv">7</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">16</span><span class="sc">}</span><span class="vs">" y2="350" stroke="black" /&gt;</span></span>
<span id="cb8-786"><a href=""></a></span>
<span id="cb8-787"><a href=""></a><span class="vs">    &lt;g class="node" id="n1" transform="translate(</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">2</span><span class="sc">}</span><span class="vs">, 50)"&gt;</span></span>
<span id="cb8-788"><a href=""></a><span class="vs">      &lt;circle r="35" fill="</span><span class="sc">${</span><span class="bu">root</span><span class="sc">}</span><span class="vs">" stroke="black"&gt;&lt;/circle&gt;</span></span>
<span id="cb8-789"><a href=""></a><span class="vs">      &lt;text class="value" fill="white" text-anchor="middle" alignment-baseline="central"&gt;root&lt;/text&gt;</span></span>
<span id="cb8-790"><a href=""></a><span class="vs">      &lt;text class="balance" fill="#C00" transform="translate(3, 25)" alignment-baseline="hanging" style="font-weight:bold"&gt;-2&lt;/text&gt;</span></span>
<span id="cb8-791"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb8-792"><a href=""></a><span class="vs">    &lt;g class="node" id="n2" transform="translate(</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">, 150)"&gt;</span></span>
<span id="cb8-793"><a href=""></a><span class="vs">      &lt;circle r="35" fill="</span><span class="sc">${</span>pivot<span class="sc">}</span><span class="vs">" stroke="black"&gt;&lt;/circle&gt;</span></span>
<span id="cb8-794"><a href=""></a><span class="vs">      &lt;text class="value" fill="white" text-anchor="middle" alignment-baseline="central"&gt;pivot&lt;/text&gt;</span></span>
<span id="cb8-795"><a href=""></a><span class="vs">      &lt;text class="balance" fill="#090" transform="translate(3, 25)" alignment-baseline="hanging"&gt;+1&lt;/text&gt;</span></span>
<span id="cb8-796"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb8-797"><a href=""></a><span class="vs">    &lt;g class="node" id="n3" transform="translate(</span><span class="sc">${</span><span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span><span class="sc">}</span><span class="vs">, 150)"&gt;</span></span>
<span id="cb8-798"><a href=""></a><span class="vs">      &lt;polygon points="0, 0 25, 200 -25, 200" fill="white" stroke="black" /&gt;</span></span>
<span id="cb8-799"><a href=""></a><span class="vs">      &lt;text fill="black" y="125" text-anchor="middle" alignment-baseline="central"&gt;h+1&lt;/text&gt;</span></span>
<span id="cb8-800"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb8-801"><a href=""></a><span class="vs">    &lt;g class="node" id="n4" transform="translate(</span><span class="sc">${</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">, 250)"&gt;</span></span>
<span id="cb8-802"><a href=""></a><span class="vs">      &lt;polygon points="0, 0 25, 200 -25, 200" fill="white" stroke="black" /&gt;</span></span>
<span id="cb8-803"><a href=""></a><span class="vs">      &lt;text fill="black" y="125" text-anchor="middle" alignment-baseline="central"&gt;h+1&lt;/text&gt;</span></span>
<span id="cb8-804"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb8-805"><a href=""></a><span class="vs">    &lt;g class="node" id="n5" transform="translate(</span><span class="sc">${</span><span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span><span class="sc">}</span><span class="vs">, 250)"&gt;</span></span>
<span id="cb8-806"><a href=""></a><span class="vs">      &lt;circle r="35" fill="</span><span class="sc">${</span>secondary<span class="sc">}</span><span class="vs">" stroke="black"&gt;&lt;/circle&gt;</span></span>
<span id="cb8-807"><a href=""></a><span class="vs">      &lt;text class="value" fill="white" text-anchor="middle" alignment-baseline="central"&gt;sec&lt;/text&gt;</span></span>
<span id="cb8-808"><a href=""></a><span class="vs">      &lt;text class="balance" fill="#C00" transform="translate(15, 20)" alignment-baseline="hanging"&gt;-1&lt;/text&gt;</span></span>
<span id="cb8-809"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb8-810"><a href=""></a><span class="vs">    &lt;g class="node" id="n10" transform="translate(</span><span class="sc">${</span><span class="dv">5</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">16</span><span class="sc">}</span><span class="vs">, 350)"&gt;</span></span>
<span id="cb8-811"><a href=""></a><span class="vs">      &lt;polygon points="0, 0 25, 100 -25, 100" fill="white" stroke="black" /&gt;</span></span>
<span id="cb8-812"><a href=""></a><span class="vs">      &lt;text fill="black" y="50" text-anchor="middle" alignment-baseline="central"&gt;h&lt;/text&gt;</span></span>
<span id="cb8-813"><a href=""></a><span class="vs">      &lt;line x1="0" y1="100" x2="0" y2="175" stroke="black" stroke-dasharray="4" /&gt;</span></span>
<span id="cb8-814"><a href=""></a><span class="vs">      &lt;circle cy="175" r="10" stroke-dasharray="4" fill="white" stroke="black"&gt;&lt;/circle&gt;</span></span>
<span id="cb8-815"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb8-816"><a href=""></a><span class="vs">    &lt;g class="node" id="n11" transform="translate(</span><span class="sc">${</span><span class="dv">7</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">16</span><span class="sc">}</span><span class="vs">, 350)"&gt;</span></span>
<span id="cb8-817"><a href=""></a><span class="vs">      &lt;polygon points="0, 0 25, 100 -25, 100" fill="white" stroke="black" /&gt;</span></span>
<span id="cb8-818"><a href=""></a><span class="vs">      &lt;text fill="black" y="50" text-anchor="middle" alignment-baseline="central"&gt;h&lt;/text&gt;</span></span>
<span id="cb8-819"><a href=""></a><span class="vs">      &lt;line x1="0" y1="100" x2="0" y2="175" stroke="black" stroke-dasharray="4" visibility="hidden" /&gt;</span></span>
<span id="cb8-820"><a href=""></a><span class="vs">      &lt;circle cy="175" r="10" stroke-dasharray="4" fill="white" stroke="black" visibility="hidden" &gt;&lt;/circle&gt;</span></span>
<span id="cb8-821"><a href=""></a><span class="vs">    &lt;/g&gt;</span></span>
<span id="cb8-822"><a href=""></a><span class="vs"> &lt;/svg&gt;</span></span>
<span id="cb8-823"><a href=""></a><span class="vs">  &lt;/figure&gt;`</span><span class="op">;</span></span>
<span id="cb8-824"><a href=""></a>  </span>
<span id="cb8-825"><a href=""></a>  <span class="kw">const</span> tree_view <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(view)<span class="op">;</span></span>
<span id="cb8-826"><a href=""></a>  <span class="kw">var</span> t <span class="op">=</span> d3<span class="op">.</span><span class="fu">transition</span>()<span class="op">;</span></span>
<span id="cb8-827"><a href=""></a>    </span>
<span id="cb8-828"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#e12"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb8-829"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb8-830"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb8-831"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb8-832"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-833"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-834"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-835"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb8-836"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb8-837"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb8-838"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">50</span>)</span>
<span id="cb8-839"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-840"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-841"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb8-842"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb8-843"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">50</span>)</span>
<span id="cb8-844"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">4</span>) </span>
<span id="cb8-845"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb8-846"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-847"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-848"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb8-849"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb8-850"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#e13"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb8-851"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb8-852"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb8-853"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb8-854"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-855"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-856"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-857"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb8-858"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb8-859"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">7</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>)</span>
<span id="cb8-860"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">250</span>)</span>
<span id="cb8-861"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-862"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-863"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb8-864"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb8-865"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">50</span>)</span>
<span id="cb8-866"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb8-867"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb8-868"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-869"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-870"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb8-871"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb8-872"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#e24"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb8-873"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb8-874"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb8-875"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb8-876"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-877"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">8</span>)</span>
<span id="cb8-878"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">250</span>)</span>
<span id="cb8-879"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">16</span>)</span>
<span id="cb8-880"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">350</span>)</span>
<span id="cb8-881"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-882"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-883"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb8-884"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb8-885"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">8</span>)</span>
<span id="cb8-886"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">250</span>)</span>
<span id="cb8-887"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-888"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-889"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb8-890"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-891"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-892"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb8-893"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb8-894"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#e25"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb8-895"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb8-896"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb8-897"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb8-898"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-899"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">8</span>)</span>
<span id="cb8-900"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">250</span>)</span>
<span id="cb8-901"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb8-902"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb8-903"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-904"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-905"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb8-906"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb8-907"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb8-908"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">50</span>)</span>
<span id="cb8-909"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-910"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-911"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb8-912"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb8-913"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb8-914"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>)</span>
<span id="cb8-915"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">250</span>)</span>
<span id="cb8-916"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-917"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-918"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb8-919"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb8-920"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#e510"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb8-921"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb8-922"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb8-923"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb8-924"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-925"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">8</span>)</span>
<span id="cb8-926"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">250</span>)</span>
<span id="cb8-927"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">16</span>)</span>
<span id="cb8-928"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">350</span>)</span>
<span id="cb8-929"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-930"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-931"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb8-932"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb8-933"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>)</span>
<span id="cb8-934"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">250</span>)</span>
<span id="cb8-935"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-936"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-937"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb8-938"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>)</span>
<span id="cb8-939"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">250</span>)</span>
<span id="cb8-940"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">5</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">16</span>)</span>
<span id="cb8-941"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">350</span>)</span>
<span id="cb8-942"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-943"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-944"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb8-945"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb8-946"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#e511"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb8-947"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb8-948"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb8-949"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb8-950"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-951"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb8-952"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb8-953"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>)</span>
<span id="cb8-954"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">250</span>)</span>
<span id="cb8-955"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-956"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-957"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb8-958"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb8-959"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">5</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>)</span>
<span id="cb8-960"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">250</span>)</span>
<span id="cb8-961"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-962"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-963"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb8-964"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>)</span>
<span id="cb8-965"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">250</span>)</span>
<span id="cb8-966"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">7</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">16</span>)</span>
<span id="cb8-967"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="dv">350</span>)</span>
<span id="cb8-968"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-969"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-970"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb8-971"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb8-972"><a href=""></a></span>
<span id="cb8-973"><a href=""></a>  </span>
<span id="cb8-974"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n1"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb8-975"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb8-976"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb8-977"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb8-978"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-979"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-980"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-981"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (<span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span>) <span class="op">+</span> <span class="st">", 150)"</span>)</span>
<span id="cb8-982"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-983"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-984"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb8-985"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (ewidth<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span> <span class="st">", 50)"</span>)</span>
<span id="cb8-986"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-987"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-988"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb8-989"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb8-990"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n1&gt;.balance"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb8-991"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb8-992"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb8-993"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb8-994"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-995"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-996"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-997"><a href=""></a>          <span class="op">.</span><span class="fu">textTween</span>(() <span class="kw">=&gt;</span> ((t) <span class="kw">=&gt;</span> t <span class="op">&lt;=</span> <span class="fl">0.5</span> <span class="op">?</span> <span class="st">"-2"</span> <span class="op">:</span> <span class="st">"+1"</span>))</span>
<span id="cb8-998"><a href=""></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#090"</span>)</span>
<span id="cb8-999"><a href=""></a>          <span class="op">.</span><span class="fu">styleTween</span>(<span class="st">"font-weight"</span><span class="op">,</span> () <span class="kw">=&gt;</span> ((t) <span class="kw">=&gt;</span> t <span class="op">&lt;=</span> <span class="fl">0.5</span> <span class="op">?</span> <span class="st">"bold"</span> <span class="op">:</span><span class="st">"normal"</span>))</span>
<span id="cb8-1000"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1001"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-1002"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb8-1003"><a href=""></a>          <span class="op">.</span><span class="fu">text</span>(<span class="op">-</span><span class="dv">2</span>)</span>
<span id="cb8-1004"><a href=""></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#c00"</span>)</span>
<span id="cb8-1005"><a href=""></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="st">"bold"</span>)</span>
<span id="cb8-1006"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1007"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-1008"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb8-1009"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb8-1010"><a href=""></a>  </span>
<span id="cb8-1011"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n2"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb8-1012"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb8-1013"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb8-1014"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb8-1015"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-1016"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (ewidth<span class="op">/</span><span class="dv">8</span>) <span class="op">+</span> <span class="st">", 250)"</span>)</span>
<span id="cb8-1017"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1018"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-1019"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (ewidth<span class="op">/</span><span class="dv">4</span>) <span class="op">+</span> <span class="st">", 150)"</span>)</span>
<span id="cb8-1020"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1021"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-1022"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb8-1023"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1024"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-1025"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb8-1026"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb8-1027"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n2&gt;.balance"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb8-1028"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb8-1029"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb8-1030"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb8-1031"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-1032"><a href=""></a>          <span class="op">.</span><span class="fu">textTween</span>(() <span class="kw">=&gt;</span> ((t) <span class="kw">=&gt;</span> t <span class="op">&lt;=</span> <span class="fl">0.5</span> <span class="op">?</span> <span class="st">"+1"</span> <span class="op">:</span> <span class="st">"0"</span>))</span>
<span id="cb8-1033"><a href=""></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)</span>
<span id="cb8-1034"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate(15,20)"</span>)</span>
<span id="cb8-1035"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1036"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-1037"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate(3,25)"</span>)</span>
<span id="cb8-1038"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1039"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-1040"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb8-1041"><a href=""></a>          <span class="op">.</span><span class="fu">text</span>(<span class="st">"+1"</span>)</span>
<span id="cb8-1042"><a href=""></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#090"</span>)</span>
<span id="cb8-1043"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1044"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-1045"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb8-1046"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb8-1047"><a href=""></a></span>
<span id="cb8-1048"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n3"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb8-1049"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb8-1050"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb8-1051"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb8-1052"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-1053"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1054"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-1055"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (<span class="dv">7</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>) <span class="op">+</span> <span class="st">", 250)"</span>)</span>
<span id="cb8-1056"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1057"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-1058"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb8-1059"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (<span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">4</span>) <span class="op">+</span> <span class="st">", 150)"</span>)</span>
<span id="cb8-1060"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1061"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-1062"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb8-1063"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb8-1064"><a href=""></a></span>
<span id="cb8-1065"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n4"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb8-1066"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb8-1067"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb8-1068"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb8-1069"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-1070"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (ewidth<span class="op">/</span><span class="dv">16</span>) <span class="op">+</span> <span class="st">", 350)"</span>)</span>
<span id="cb8-1071"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1072"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-1073"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (ewidth<span class="op">/</span><span class="dv">8</span>) <span class="op">+</span> <span class="st">", 250)"</span>)</span>
<span id="cb8-1074"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1075"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-1076"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb8-1077"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1078"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-1079"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb8-1080"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb8-1081"><a href=""></a></span>
<span id="cb8-1082"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n5"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb8-1083"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb8-1084"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb8-1085"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb8-1086"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-1087"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (ewidth<span class="op">/</span><span class="dv">4</span>) <span class="op">+</span> <span class="st">", 150)"</span>)</span>
<span id="cb8-1088"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1089"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-1090"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (ewidth<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span> <span class="st">", 50)"</span>)</span>
<span id="cb8-1091"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1092"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-1093"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb8-1094"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (<span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>) <span class="op">+</span> <span class="st">", 250)"</span>)</span>
<span id="cb8-1095"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1096"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-1097"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb8-1098"><a href=""></a>  })<span class="op">;</span></span>
<span id="cb8-1099"><a href=""></a>  tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n5&gt;.balance"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb8-1100"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb8-1101"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb8-1102"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb8-1103"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-1104"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate(3, 25)"</span>)</span>
<span id="cb8-1105"><a href=""></a>          <span class="op">.</span><span class="fu">textTween</span>(() <span class="kw">=&gt;</span> ((t) <span class="kw">=&gt;</span> t <span class="op">&lt;=</span> <span class="fl">0.5</span> <span class="op">?</span> <span class="st">"-1"</span> <span class="op">:</span> <span class="st">"-2"</span>))</span>
<span id="cb8-1106"><a href=""></a>          <span class="op">.</span><span class="fu">styleTween</span>(<span class="st">"font-weight"</span><span class="op">,</span> () <span class="kw">=&gt;</span> ((t) <span class="kw">=&gt;</span> t <span class="op">&lt;=</span> <span class="fl">0.5</span> <span class="op">?</span> <span class="st">"normal"</span> <span class="op">:</span><span class="st">"bold"</span>))</span>
<span id="cb8-1107"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1108"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-1109"><a href=""></a>          <span class="op">.</span><span class="fu">textTween</span>(() <span class="kw">=&gt;</span> ((t) <span class="kw">=&gt;</span> t <span class="op">&lt;=</span> <span class="fl">0.5</span> <span class="op">?</span> <span class="st">"-2"</span> <span class="op">:</span> <span class="st">"0"</span>))</span>
<span id="cb8-1110"><a href=""></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)</span>
<span id="cb8-1111"><a href=""></a>          <span class="op">.</span><span class="fu">styleTween</span>(<span class="st">"font-weight"</span><span class="op">,</span> () <span class="kw">=&gt;</span> ((t) <span class="kw">=&gt;</span> t <span class="op">&lt;=</span> <span class="fl">0.5</span> <span class="op">?</span> <span class="st">"bold"</span> <span class="op">:</span><span class="st">"normal"</span>))</span>
<span id="cb8-1112"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1113"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-1114"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb8-1115"><a href=""></a>          <span class="op">.</span><span class="fu">text</span>(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb8-1116"><a href=""></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#c00"</span>)</span>
<span id="cb8-1117"><a href=""></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="st">"normal"</span>)</span>
<span id="cb8-1118"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate(15, 20)"</span>)</span>
<span id="cb8-1119"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1120"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-1121"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb8-1122"><a href=""></a>    })<span class="op">;</span></span>
<span id="cb8-1123"><a href=""></a></span>
<span id="cb8-1124"><a href=""></a>    tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n10"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb8-1125"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb8-1126"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb8-1127"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb8-1128"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-1129"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (<span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">16</span>) <span class="op">+</span> <span class="st">", 350)"</span>)</span>
<span id="cb8-1130"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1131"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-1132"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (<span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>) <span class="op">+</span> <span class="st">", 250)"</span>)</span>
<span id="cb8-1133"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1134"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-1135"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb8-1136"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (<span class="dv">5</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">16</span>) <span class="op">+</span> <span class="st">", 350)"</span>)</span>
<span id="cb8-1137"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1138"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-1139"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb8-1140"><a href=""></a>    })<span class="op">;</span></span>
<span id="cb8-1141"><a href=""></a></span>
<span id="cb8-1142"><a href=""></a>    tree_view<span class="op">.</span><span class="fu">select</span>(<span class="st">"#n11"</span>)<span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb8-1143"><a href=""></a>    <span class="op">.</span><span class="fu">delay</span>(<span class="dv">1000</span>)</span>
<span id="cb8-1144"><a href=""></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> <span class="kw">function</span> <span class="fu">repeat</span>() {</span>
<span id="cb8-1145"><a href=""></a>      d3<span class="op">.</span><span class="fu">active</span>(<span class="kw">this</span>)</span>
<span id="cb8-1146"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-1147"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (<span class="dv">3</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>) <span class="op">+</span> <span class="st">", 250)"</span>)</span>
<span id="cb8-1148"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1149"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(dur)</span>
<span id="cb8-1150"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (<span class="dv">5</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">8</span>) <span class="op">+</span> <span class="st">", 250)"</span>)</span>
<span id="cb8-1151"><a href=""></a>         <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1152"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-1153"><a href=""></a>          <span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)</span>
<span id="cb8-1154"><a href=""></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate("</span> <span class="op">+</span> (<span class="dv">7</span><span class="op">*</span>ewidth<span class="op">/</span><span class="dv">16</span>) <span class="op">+</span> <span class="st">", 350)"</span>)</span>
<span id="cb8-1155"><a href=""></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb8-1156"><a href=""></a>          <span class="op">.</span><span class="fu">delay</span>(dur)</span>
<span id="cb8-1157"><a href=""></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"start"</span><span class="op">,</span> repeat)<span class="op">;</span></span>
<span id="cb8-1158"><a href=""></a>     })<span class="op">;</span></span>
<span id="cb8-1159"><a href=""></a></span>
<span id="cb8-1160"><a href=""></a>  <span class="cf">return</span> view<span class="op">;</span></span>
<span id="cb8-1161"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-5" data-nodetype="expression">

</div>
</div>
</div>

<div class="absolute" style="top: 100px; left: 650px; ">
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource cpp number-lines code-with-copy"><code class="sourceCode cpp"><span id="cb9-1"><a href=""></a><span class="at">static</span> <span class="dt">void</span> LR <span class="op">(</span>Node<span class="op">*&amp;</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-2"><a href=""></a>    RR<span class="op">(</span>p<span class="op">-&gt;</span>left<span class="op">);</span></span>
<span id="cb9-3"><a href=""></a>    LL<span class="op">(</span>p<span class="op">);</span></span>
<span id="cb9-4"><a href=""></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside><div>
<p>It does not matter to which of the subtrees of “sec” the new node it is added. The same construction works for both cases. (The final balances are different though.)</p>
<p><strong>Credits</strong>: the animations of the rotations are from <a href="https://observablehq.com/@infowantstobeseen/avl-trees-understanding-rotations">this blog-post</a> on understanding AVL rotations.</p>
</div></aside></section>
<section id="lr-double-rotations-correctness" class="slide level2">
<h2>LR double rotations — <em>correctness</em></h2>
<p><img data-src="assets/LR-1.png" style="width:25.0%"> <img data-src="assets/LR-2.png" style="width:25.0%"> <img data-src="assets/LR-3.png" style="width:30.0%"></p>
<ul>
<li>LR rotations preserve the BST properties of the tree (<span class="alert">check!</span>)</li>
<li>LR rotations fix the unbalance (in the LL case) (<span class="alert">check!</span>)</li>
</ul>

<aside><div>
<p>It does not matter to which of the subtrees of “sec” the new node it is added. The same construction works for both cases. (The final balances are different though.)</p>
</div></aside></section>
<section id="rl-rotation" class="slide level2">
<h2>RL rotation</h2>
<p>analogous to the LR case, just symmetric.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource cpp number-lines code-with-copy"><code class="sourceCode cpp"><span id="cb10-1"><a href=""></a><span class="at">static</span> <span class="dt">void</span> RL <span class="op">(</span>Node<span class="op">*&amp;</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-2"><a href=""></a>    LL<span class="op">(</span>p<span class="op">-&gt;</span>right<span class="op">);</span></span>
<span id="cb10-3"><a href=""></a>    RR<span class="op">(</span>p<span class="op">);</span></span>
<span id="cb10-4"><a href=""></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="insertion-in-an-avl-implementation" class="slide level2">
<h2>Insertion in an AVL — <em>implementation</em></h2>
<div class="sourceCode" id="annotated-cell-9"><pre class="sourceCode numberSource cpp code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode cpp"><span id="annotated-cell-9-1"><a href="#annotated-cell-9-1"></a><span class="kw">public</span><span class="op">:</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="1">1</button><span id="annotated-cell-9-2" class="code-annotation-target"><a href="#annotated-cell-9-2"></a>    <span class="dt">void</span> assign <span class="op">(</span><span class="at">const</span> Key<span class="op">&amp;</span> key<span class="op">,</span> <span class="at">const</span> Info<span class="op">&amp;</span> info<span class="op">)</span> <span class="op">{</span></span>
<span id="annotated-cell-9-3"><a href="#annotated-cell-9-3"></a>        assign<span class="op">(</span>root<span class="op">,</span> key<span class="op">,</span> info<span class="op">);</span></span>
<span id="annotated-cell-9-4"><a href="#annotated-cell-9-4"></a>    <span class="op">}</span></span>
<span id="annotated-cell-9-5"><a href="#annotated-cell-9-5"></a><span class="kw">private</span><span class="op">:</span>    </span>
<span id="annotated-cell-9-6"><a href="#annotated-cell-9-6"></a>    <span class="dt">void</span> assign <span class="op">(</span>Node<span class="op">*&amp;</span> p<span class="op">,</span> <span class="at">const</span> Key<span class="op">&amp;</span> key<span class="op">,</span> <span class="at">const</span> Info<span class="op">&amp;</span> info<span class="op">)</span> <span class="op">{</span></span>
<span id="annotated-cell-9-7"><a href="#annotated-cell-9-7"></a>        <span class="cf">if</span> <span class="op">(</span>p<span class="op">)</span> <span class="op">{</span></span>
<span id="annotated-cell-9-8"><a href="#annotated-cell-9-8"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">&lt;</span> p<span class="op">-&gt;</span>key<span class="op">)</span> <span class="op">{</span></span>
<span id="annotated-cell-9-9"><a href="#annotated-cell-9-9"></a>                assign<span class="op">(</span>p<span class="op">-&gt;</span>left<span class="op">,</span> key<span class="op">,</span> info<span class="op">);</span></span>
<span id="annotated-cell-9-10"><a href="#annotated-cell-9-10"></a>                <span class="cf">if</span> <span class="op">(</span>height<span class="op">(</span>p<span class="op">-&gt;</span>left<span class="op">)-</span>height<span class="op">(</span>p<span class="op">-&gt;</span>right<span class="op">)</span> <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="annotated-cell-9-11"><a href="#annotated-cell-9-11"></a>                    <span class="cf">if</span> <span class="op">(</span>key <span class="op">&lt;</span> p<span class="op">-&gt;</span>left<span class="op">-&gt;</span>key<span class="op">)</span> LL<span class="op">(</span>p<span class="op">);</span></span>
<span id="annotated-cell-9-12"><a href="#annotated-cell-9-12"></a>                    <span class="cf">else</span> LR<span class="op">(</span>p<span class="op">);</span></span>
<span id="annotated-cell-9-13"><a href="#annotated-cell-9-13"></a>                <span class="op">}</span></span>
<span id="annotated-cell-9-14"><a href="#annotated-cell-9-14"></a>                update_height<span class="op">(</span>p<span class="op">);</span></span>
<span id="annotated-cell-9-15"><a href="#annotated-cell-9-15"></a>            <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>key <span class="op">&gt;</span> p<span class="op">-&gt;</span>key<span class="op">)</span> <span class="op">{</span></span>
<span id="annotated-cell-9-16"><a href="#annotated-cell-9-16"></a>                assign<span class="op">(</span>p<span class="op">-&gt;</span>right<span class="op">,</span> key<span class="op">,</span> info<span class="op">);</span></span>
<span id="annotated-cell-9-17"><a href="#annotated-cell-9-17"></a>                <span class="cf">if</span> <span class="op">(</span>height<span class="op">(</span>p<span class="op">-&gt;</span>right<span class="op">)-</span>height<span class="op">(</span>p<span class="op">-&gt;</span>left<span class="op">)</span> <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="annotated-cell-9-18"><a href="#annotated-cell-9-18"></a>                    <span class="cf">if</span> <span class="op">(</span>key <span class="op">&gt;</span> p<span class="op">-&gt;</span>right<span class="op">-&gt;</span>key<span class="op">)</span> RR<span class="op">(</span>p<span class="op">);</span></span>
<span id="annotated-cell-9-19"><a href="#annotated-cell-9-19"></a>                    <span class="cf">else</span> RL<span class="op">(</span>p<span class="op">);</span></span>
<span id="annotated-cell-9-20"><a href="#annotated-cell-9-20"></a>                <span class="op">}</span></span>
<span id="annotated-cell-9-21"><a href="#annotated-cell-9-21"></a>            <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="annotated-cell-9-22"><a href="#annotated-cell-9-22"></a>                update_height<span class="op">(</span>p<span class="op">);</span></span>
<span id="annotated-cell-9-23"><a href="#annotated-cell-9-23"></a>                p<span class="op">-&gt;</span>info <span class="op">=</span> info<span class="op">;</span></span>
<span id="annotated-cell-9-24"><a href="#annotated-cell-9-24"></a>            <span class="op">}</span></span>
<span id="annotated-cell-9-25"><a href="#annotated-cell-9-25"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="annotated-cell-9-26"><a href="#annotated-cell-9-26"></a>            <span class="op">++</span>n<span class="op">;</span></span>
<span id="annotated-cell-9-27"><a href="#annotated-cell-9-27"></a>            p <span class="op">=</span> <span class="kw">new</span> Node<span class="op">(</span>key<span class="op">,</span> info<span class="op">,</span> <span class="kw">nullptr</span><span class="op">,</span> <span class="kw">nullptr</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="annotated-cell-9-28"><a href="#annotated-cell-9-28"></a>        <span class="op">}</span> </span>
<span id="annotated-cell-9-29"><a href="#annotated-cell-9-29"></a>    <span class="op">}</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-9" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="2" data-code-annotation="1">This is the same as the usual BST tree.</span>
</dd>
</dl>
<p>The worst-case cost of an insertion in an AVL is <span class="math inline">\Theta(\log n)</span>.</p>
</section>
<section id="deletion-in-an-avl" class="slide level2">
<h2>Deletion in an AVL</h2>
<p>The deletion algorithm for AVLs draws upon the same ideas: delete as in a normal BST and then fix the unbalances. The analysis to determine what rotation must be applied is a bit more complex.</p>
<p>The worst-case of deletions in AVLs is <span class="math inline">\Theta(\log n)</span>. Unbalance in a node is corrected by a simple or a double rotation, but it might be necessary to apply several rotations to fix the balance. However, not more than a rotation is necessary in any given node in the path from the root to the deletion point, since they are only <span class="math inline">\mathcal O(\log n)</span>, the worst-case is also <span class="math inline">\Theta(\log n)</span>.</p>
</section></section>
<section>
<section id="heaps-and-priority-queues" class="title-slide slide level1 center">
<h1>Heaps and Priority Queues</h1>

</section>
<section id="perfect-binary-tree" class="slide level2">
<h2>Perfect Binary Tree</h2>
<p>A binary tree is <span class="def">perfect</span> if all the internal nodes have <span class="math inline">2</span> children and all the leaves have the same depth/height.</p>
<div class="fragment">
<div id="thm-" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2</strong></span> For a <strong>perfect</strong> binary tree of depth <span class="math inline">d</span> and <span class="math inline">n</span> nodes, it holds that <span class="math display">
n=2^{d+1}-1\ .
</span></p>
</div>
<p>(Proof at the blackboard)</p>
</div>
</section>
<section id="complete-binary-tree" class="slide level2">
<h2>Complete Binary Tree</h2>
<p>A binary tree of depth <span class="math inline">d</span> is <span class="def">complete</span> if</p>
<ul>
<li>all the nodes at depth <span class="math inline">\leq d-2</span> have exactly <span class="math inline">2</span> children</li>
<li>the nodes at depth <span class="math inline">d</span> are filled from left to right <span class="alert"><em>without leaving empty spots</em></span></li>
</ul>
<div class="fragment">
<div id="thm-" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3</strong></span> For a <strong>complete</strong> binary tree of depth <span class="math inline">d</span> and <span class="math inline">n</span> nodes, it holds that <span class="math display">
2^d\leq n\leq 2^{d+1}-1\ .
</span> Which implies, <span class="math inline">d=\lfloor \log_2 n\rfloor</span> and <span class="math inline">d=\Theta(\log n)</span>.</p>
</div>
<p>(Proof at the blackboard)</p>
</div>
</section>
<section id="priority-queues" class="slide level2">
<h2>Priority Queues</h2>
<p>A <span class="def">priority queue</span> (cat: <span class="def">cua de prioritat</span>; esp: <span class="def">cola de prioridad</span>) stores a collection of elements, each one associated with a value called its <em>priority</em>.</p>
<p>Priority queues support the insertion of new elements and the query and removal of an element of minimum (or maximum) priority.</p>
</section>
<section id="section-1" class="slide level2">
<h2></h2>
<div class="column" style="width:65%;">
<div class="sourceCode" id="annotated-cell-23"><pre class="sourceCode numberSource cpp code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode cpp"><span id="annotated-cell-23-1"><a href="#annotated-cell-23-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> Elem<span class="op">,</span> <span class="kw">typename</span> Prio<span class="op">&gt;</span></span>
<span id="annotated-cell-23-2"><a href="#annotated-cell-23-2"></a></span>
<span id="annotated-cell-23-3"><a href="#annotated-cell-23-3"></a><span class="kw">class</span> PriorityQueue <span class="op">{</span></span>
<span id="annotated-cell-23-4"><a href="#annotated-cell-23-4"></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="annotated-cell-23-5"><a href="#annotated-cell-23-5"></a>        <span class="op">...</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-23" data-target-annotation="1">1</button><span id="annotated-cell-23-6" class="code-annotation-target"><a href="#annotated-cell-23-6"></a>        <span class="dt">void</span> insert<span class="op">(</span>cons Elem<span class="op">&amp;</span> x<span class="op">,</span> <span class="at">const</span> Prio<span class="op">&amp;</span> p<span class="op">);</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-23" data-target-annotation="2">2</button><span id="annotated-cell-23-7" class="code-annotation-target"><a href="#annotated-cell-23-7"></a>        Elem min<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-23" data-target-annotation="3">3</button><span id="annotated-cell-23-8" class="code-annotation-target"><a href="#annotated-cell-23-8"></a>        Prio min_prio<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-23" data-target-annotation="4">4</button><span id="annotated-cell-23-9" class="code-annotation-target"><a href="#annotated-cell-23-9"></a>        <span class="dt">void</span> remove_min<span class="op">();</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-23" data-target-annotation="5">5</button><span id="annotated-cell-23-10" class="code-annotation-target"><a href="#annotated-cell-23-10"></a>        <span class="dt">bool</span> empty<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="annotated-cell-23-11"><a href="#annotated-cell-23-11"></a><span class="op">};</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-23" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-23" data-code-lines="6" data-code-annotation="1">Adds an element x with priority p to the priority queue.</span>
</dd>
<dt data-target-cell="annotated-cell-23" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-23" data-code-lines="7" data-code-annotation="2">Returns an element of minimum priority; throws an exception if the queue is empty.</span>
</dd>
<dt data-target-cell="annotated-cell-23" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-23" data-code-lines="8" data-code-annotation="3">Returns the priority of an element of minimum priority; throws an exception if the queue is empty.</span>
</dd>
<dt data-target-cell="annotated-cell-23" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-23" data-code-lines="9" data-code-annotation="4">Removes an element of minimum priority; throws an exception if the queue is empty.</span>
</dd>
<dt data-target-cell="annotated-cell-23" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-23" data-code-lines="10" data-code-annotation="5">Returns true iff the priority queue is empty</span>
</dd>
</dl>
</div><ul>
<li><p>Several techniques that we have seen for the implementation of dictionaries can also be used for priority queues (<strong>not hash tables</strong>).</p></li>
<li><p>For instance, AVL trees can be used to implement a priority queue with cost <span class="math inline">\mathcal O(\log n)</span> for insertions and deletions</p></li>
</ul>
</section>
<section id="min-heaps" class="slide level2">
<h2>Min-Heaps</h2>
<p>A <span class="def">min-heap</span> (cat: <span class="def">munt</span> o <span class="def">munticles</span>) is complete binary tree such that for each node its priority is smaller than the one of its children. <span class="def">Max-heaps</span> are defines analogously.</p>
<p><span class="question">Where is in the tree the element with smaller priority?</span></p>

<aside><div>
<p>When we talk of a heap without specifying whether it is a max-heap or a min-heap, we intend it to be a min-heap.</p>
</div></aside></section>
<section id="representation-of-a-heap" class="slide level2">
<h2>Representation of a heap</h2>
<p>A (min-)heap with <span class="math inline">n</span> elements can be represented as a vector <span class="math inline">T</span> with <span class="math inline">n+1</span> positions. <span class="math inline">T[i]</span> contains the priority of the node <span class="math inline">i</span>.</p>
<ul>
<li>The root of the tree is the node <span class="math inline">1</span>.</li>
<li>The left child of <span class="math inline">i</span> is <span class="math inline">2i</span> (if <span class="math inline">2i\leq n</span>).</li>
<li>The right child of <span class="math inline">i</span> is <span class="math inline">2i +1</span> (if <span class="math inline">2i+1\leq n</span>).</li>
<li>For every <span class="math inline">i</span>, <span class="math inline">T[i]\leq T[2i]</span> and <span class="math inline">T[i]\leq T[2i+1]</span>.</li>
</ul>
<div class="fragment">
<p><span class="question">What would change if we wanted to store a <strong>max</strong>-heap?</span></p>
</div>
<div class="fragment">
<p><span class="question">Why using <span class="math inline">0</span> to store the root is not a good idea?</span></p>
</div>
<div class="fragment">
<p><span class="question">Where is the parent/father of <span class="math inline">i</span>?</span></p>
</div>
<div class="fragment">
<p><span class="question">How many leaves a heap with say <span class="math inline">2n</span> elements have?</span></p>
</div>
</section>
<section id="section-2" class="slide level2">
<h2></h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource cpp number-lines code-with-copy"><code class="sourceCode cpp"><span id="cb11-1"><a href=""></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> Elem<span class="op">,</span> <span class="kw">typename</span> Prio<span class="op">&gt;</span></span>
<span id="cb11-2"><a href=""></a><span class="kw">class</span> PriorityQueue <span class="op">{</span></span>
<span id="cb11-3"><a href=""></a>    <span class="kw">public</span><span class="op">:</span></span>
<span id="cb11-4"><a href=""></a>        <span class="op">...</span></span>
<span id="cb11-5"><a href=""></a>    <span class="kw">private</span><span class="op">:</span></span>
<span id="cb11-6"><a href=""></a>        vector<span class="op">&lt;</span>pair<span class="op">&lt;</span>Elem<span class="op">,</span> Prio<span class="op">&gt;&gt;</span> h<span class="op">;</span> <span class="co">// Component of index 0 is not used</span></span>
<span id="cb11-7"><a href=""></a>        <span class="dt">int</span> nelems<span class="op">;</span></span>
<span id="cb11-8"><a href=""></a>        <span class="dt">void</span> siftup<span class="op">(</span><span class="dt">int</span> j<span class="op">)</span> <span class="cf">throw</span><span class="op">();</span></span>
<span id="cb11-9"><a href=""></a>        <span class="dt">void</span> sink<span class="op">(</span><span class="dt">int</span> j<span class="op">)</span> <span class="cf">throw</span><span class="op">();</span></span>
<span id="cb11-10"><a href=""></a><span class="op">};</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-3" class="slide level2">
<h2></h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode numberSource cpp number-lines code-with-copy"><code class="sourceCode cpp"><span id="cb12-1"><a href=""></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> Elem<span class="op">,</span> <span class="kw">typename</span> Prio<span class="op">&gt;</span></span>
<span id="cb12-2"><a href=""></a><span class="dt">bool</span> PriorityQueue<span class="op">&lt;</span>Elem<span class="op">,</span>Prio<span class="op">&gt;::</span>empty<span class="op">()</span> <span class="at">const</span> <span class="op">{</span></span>
<span id="cb12-3"><a href=""></a>    <span class="cf">return</span> nelems <span class="op">==</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb12-4"><a href=""></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource cpp number-lines code-with-copy"><code class="sourceCode cpp"><span id="cb13-1"><a href=""></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> Elem<span class="op">,</span> <span class="kw">typename</span> Prio<span class="op">&gt;</span></span>
<span id="cb13-2"><a href=""></a>Elem PriorityQueue<span class="op">&lt;</span>Elem<span class="op">,</span>Prio<span class="op">&gt;::</span>min<span class="op">()</span> <span class="at">const</span> <span class="op">{</span></span>
<span id="cb13-3"><a href=""></a>    <span class="cf">if</span> <span class="op">(</span>nelems <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">throw</span> EmptyPriorityQueue<span class="op">;</span></span>
<span id="cb13-4"><a href=""></a>    <span class="cf">return</span> h<span class="op">[</span><span class="dv">1</span><span class="op">].</span>first<span class="op">;</span></span>
<span id="cb13-5"><a href=""></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource cpp number-lines code-with-copy"><code class="sourceCode cpp"><span id="cb14-1"><a href=""></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> Elem<span class="op">,</span> <span class="kw">typename</span> Prio<span class="op">&gt;</span></span>
<span id="cb14-2"><a href=""></a>Prio PriorityQueue<span class="op">&lt;</span>Elem<span class="op">,</span>Prio<span class="op">&gt;::</span>min_prio<span class="op">()</span> <span class="at">const</span> <span class="op">{</span></span>
<span id="cb14-3"><a href=""></a>    <span class="cf">if</span> <span class="op">(</span>nelems <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">throw</span> EmptyPriorityQueue<span class="op">;</span></span>
<span id="cb14-4"><a href=""></a>    <span class="cf">return</span> h<span class="op">[</span><span class="dv">1</span><span class="op">].</span>second<span class="op">;</span></span>
<span id="cb14-5"><a href=""></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="heaps-removing-the-minimum" class="slide level2">
<h2>Heaps: Removing the minimum</h2>
<ul>
<li>Replace the root of the heap with the last element</li>
<li>Re-establish the heap order <em>sinking</em> the new root.</li>
</ul>
<p>(see blackboard)</p>
</section>
<section id="removing-the-minimum-implementation" class="slide level2">
<h2>Removing the minimum — <em>implementation</em></h2>
<div class="sourceCode" id="annotated-cell-14"><pre class="sourceCode numberSource cpp code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode cpp"><span id="annotated-cell-14-1"><a href="#annotated-cell-14-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> Elem<span class="op">,</span> <span class="kw">typename</span> Prio<span class="op">&gt;</span></span>
<span id="annotated-cell-14-2"><a href="#annotated-cell-14-2"></a><span class="dt">void</span> PriorityQueue<span class="op">&lt;</span>Elem<span class="op">,</span>Prio<span class="op">&gt;::</span>remove_min<span class="op">()</span> <span class="at">const</span> <span class="op">{</span></span>
<span id="annotated-cell-14-3"><a href="#annotated-cell-14-3"></a>    <span class="cf">if</span> <span class="op">(</span>nelems <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">throw</span> EmptyPriorityQueue<span class="op">;</span></span>
<span id="annotated-cell-14-4"><a href="#annotated-cell-14-4"></a>        swap<span class="op">(</span>h<span class="op">[</span><span class="dv">1</span><span class="op">],</span> h<span class="op">[</span>nelems<span class="op">]);</span></span>
<span id="annotated-cell-14-5"><a href="#annotated-cell-14-5"></a>        <span class="op">--</span>nelems<span class="op">;</span></span>
<span id="annotated-cell-14-6"><a href="#annotated-cell-14-6"></a>        h<span class="op">.</span>pop_back<span class="op">();</span></span>
<span id="annotated-cell-14-7"><a href="#annotated-cell-14-7"></a>        sink<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="annotated-cell-14-8"><a href="#annotated-cell-14-8"></a>    <span class="op">}</span></span>
<span id="annotated-cell-14-9"><a href="#annotated-cell-14-9"></a></span>
<span id="annotated-cell-14-10"><a href="#annotated-cell-14-10"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> Elem<span class="op">,</span> <span class="kw">typename</span> Prio<span class="op">&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="1">1</button><span id="annotated-cell-14-11" class="code-annotation-target"><a href="#annotated-cell-14-11"></a><span class="dt">void</span> PriorityQueue<span class="op">&lt;</span>Elem<span class="op">,</span>Prio<span class="op">&gt;::</span>sink<span class="op">(</span><span class="dt">int</span> j<span class="op">)</span> <span class="op">{</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="2">2</button><span id="annotated-cell-14-12" class="code-annotation-target"><a href="#annotated-cell-14-12"></a>    <span class="cf">if</span> <span class="op">(</span><span class="dv">2</span> <span class="op">*</span> j <span class="op">&gt;</span> nelems<span class="op">)</span> <span class="cf">return</span><span class="op">;</span></span>
<span id="annotated-cell-14-13"><a href="#annotated-cell-14-13"></a>    <span class="dt">int</span> minchild <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> j<span class="op">;</span></span>
<span id="annotated-cell-14-14"><a href="#annotated-cell-14-14"></a>    <span class="cf">if</span> <span class="op">(</span>minchild <span class="op">&lt;</span> nelems <span class="kw">and</span> h<span class="op">[</span>minchild<span class="op">].</span>second <span class="op">&gt;</span> h<span class="op">[</span>minchild <span class="op">+</span> <span class="dv">1</span><span class="op">].</span>second<span class="op">)</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="3">3</button><span id="annotated-cell-14-15" class="code-annotation-target"><a href="#annotated-cell-14-15"></a>        <span class="op">++</span>minchild<span class="op">;</span></span>
<span id="annotated-cell-14-16"><a href="#annotated-cell-14-16"></a>    <span class="cf">if</span> <span class="op">(</span>h<span class="op">[</span>j<span class="op">].</span>second <span class="op">&gt;</span> h<span class="op">[</span>minchild<span class="op">].</span>second<span class="op">)</span> <span class="op">{</span></span>
<span id="annotated-cell-14-17"><a href="#annotated-cell-14-17"></a>        swap<span class="op">(</span>h<span class="op">[</span>j<span class="op">],</span> h<span class="op">[</span>minchild<span class="op">]);</span></span>
<span id="annotated-cell-14-18"><a href="#annotated-cell-14-18"></a>        sink<span class="op">(</span>minchild<span class="op">);</span></span>
<span id="annotated-cell-14-19"><a href="#annotated-cell-14-19"></a>    <span class="op">}</span></span>
<span id="annotated-cell-14-20"><a href="#annotated-cell-14-20"></a><span class="op">}</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-14" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="11" data-code-annotation="1">This function has cost <span class="math inline">\mathcal O(\log(n/j))</span></span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="12" data-code-annotation="2">if <code>j</code> has no left child we are at the last level</span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="15" data-code-annotation="3"><code>minchild</code> is the index of the child with smaller priority</span>
</dd>
</dl>
</section>
<section id="heaps-adding-a-new-element" class="slide level2">
<h2>Heaps: Adding a new element</h2>
<ul>
<li>Add the new element at the end of the vector (<em>i.e.</em> as rightmost node of the last level of the heap or as the first element of a new deeper level)</li>
<li>Re-establish the heap order <em>floating</em> the new added element</li>
</ul>
<p>(see blackboard)</p>
</section>
<section id="adding-a-new-element-implementation" class="slide level2">
<h2>Adding a new element — <em>implementation</em></h2>
<div class="sourceCode" id="annotated-cell-15"><pre class="sourceCode numberSource cpp code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode cpp"><span id="annotated-cell-15-1"><a href="#annotated-cell-15-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> Elem<span class="op">,</span> <span class="kw">typename</span> Prio<span class="op">&gt;</span></span>
<span id="annotated-cell-15-2"><a href="#annotated-cell-15-2"></a><span class="dt">void</span> PriorityQueue<span class="op">&lt;</span>Elem<span class="op">,</span>Prio<span class="op">&gt;::</span>insert<span class="op">(</span>cons Elem<span class="op">&amp;</span> x<span class="op">,</span> cons Prio<span class="op">&amp;</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="annotated-cell-15-3"><a href="#annotated-cell-15-3"></a>    <span class="op">++</span>nelems<span class="op">;</span></span>
<span id="annotated-cell-15-4"><a href="#annotated-cell-15-4"></a>    h<span class="op">.</span>push_back<span class="op">(</span>make_pair<span class="op">(</span>x<span class="op">,</span> p<span class="op">));</span></span>
<span id="annotated-cell-15-5"><a href="#annotated-cell-15-5"></a>    siftup<span class="op">(</span>nelems<span class="op">);</span></span>
<span id="annotated-cell-15-6"><a href="#annotated-cell-15-6"></a><span class="op">}</span></span>
<span id="annotated-cell-15-7"><a href="#annotated-cell-15-7"></a></span>
<span id="annotated-cell-15-8"><a href="#annotated-cell-15-8"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> Elem<span class="op">,</span> <span class="kw">typename</span> Prio<span class="op">&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-15" data-target-annotation="1">1</button><span id="annotated-cell-15-9" class="code-annotation-target"><a href="#annotated-cell-15-9"></a><span class="dt">void</span> PriorityQueue<span class="op">&lt;</span>Elem<span class="op">,</span>Prio<span class="op">&gt;::</span>siftup<span class="op">(</span><span class="dt">int</span> j<span class="op">)</span> <span class="op">{</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-15" data-target-annotation="2">2</button><span id="annotated-cell-15-10" class="code-annotation-target"><a href="#annotated-cell-15-10"></a>    <span class="cf">if</span> <span class="op">(</span>j <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span><span class="op">;</span></span>
<span id="annotated-cell-15-11"><a href="#annotated-cell-15-11"></a>    <span class="dt">int</span> father <span class="op">=</span> j <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="annotated-cell-15-12"><a href="#annotated-cell-15-12"></a>    <span class="cf">if</span> <span class="op">(</span>h<span class="op">[</span>j<span class="op">].</span>second <span class="op">&lt;</span> h<span class="op">[</span>father<span class="op">].</span>second<span class="op">)</span> <span class="op">{</span></span>
<span id="annotated-cell-15-13"><a href="#annotated-cell-15-13"></a>        swap<span class="op">(</span>h<span class="op">[</span>j<span class="op">],</span> h<span class="op">[</span>father<span class="op">]);</span></span>
<span id="annotated-cell-15-14"><a href="#annotated-cell-15-14"></a>        siftup<span class="op">(</span>father<span class="op">);</span></span>
<span id="annotated-cell-15-15"><a href="#annotated-cell-15-15"></a>    <span class="op">}</span></span>
<span id="annotated-cell-15-16"><a href="#annotated-cell-15-16"></a><span class="op">}</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-15" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-15" data-code-lines="9" data-code-annotation="1"><code>siftup</code> has cost <span class="math inline">\mathcal O(\log j)</span></span>
</dd>
<dt data-target-cell="annotated-cell-15" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-15" data-code-lines="10" data-code-annotation="2">if <code>j</code> is the root we are done</span>
</dd>
</dl>
</section>
<section id="heapsort" class="slide level2">
<h2>Heapsort</h2>
<p><span class="def">Heapsort</span> (Williams, 1964) sorts an array of <span class="math inline">n</span> elements building a heap with the <span class="math inline">n</span> elements and extracting them, one by one, from the heap.</p>
<p>The originally given array is used to build the heap; heapsort works in-place and only some constant auxiliary memory space is needed.</p>
<p>Since insertions and deletions in heaps have cost <span class="math inline">\mathcal O(\log n)</span> the cost of the algorithm is <span class="math inline">\mathcal O(n\log n)</span>.</p>
</section>
<section id="heapsort-implementation" class="slide level2">
<h2>Heapsort — <em>implementation</em></h2>
<div class="sourceCode" id="annotated-cell-16"><pre class="sourceCode numberSource cpp code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode cpp"><span id="annotated-cell-16-1"><a href="#annotated-cell-16-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> Elem<span class="op">&gt;</span></span>
<span id="annotated-cell-16-2"><a href="#annotated-cell-16-2"></a><span class="dt">void</span> sink<span class="op">(</span>Elem v<span class="op">[],</span> <span class="dt">int</span> sz<span class="op">,</span> <span class="dt">int</span> pos<span class="op">);</span></span>
<span id="annotated-cell-16-3"><a href="#annotated-cell-16-3"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> Elem<span class="op">&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-16" data-target-annotation="1">1</button><span id="annotated-cell-16-4" class="code-annotation-target"><a href="#annotated-cell-16-4"></a><span class="dt">void</span> heapsort<span class="op">(</span>Elem v<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="annotated-cell-16-5"><a href="#annotated-cell-16-5"></a>    make_heap<span class="op">(</span>v<span class="op">,</span> n<span class="op">);</span></span>
<span id="annotated-cell-16-6"><a href="#annotated-cell-16-6"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> n<span class="op">;</span> i <span class="op">&gt;</span> <span class="dv">0</span><span class="op">;</span> <span class="op">--</span>i<span class="op">)</span> <span class="op">{</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-16" data-target-annotation="2">2</button><span id="annotated-cell-16-7" class="code-annotation-target"><a href="#annotated-cell-16-7"></a>        swap<span class="op">(</span>v<span class="op">[</span><span class="dv">1</span><span class="op">],</span> v<span class="op">[</span>i<span class="op">]);</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-16" data-target-annotation="3">3</button><span id="annotated-cell-16-8" class="code-annotation-target"><a href="#annotated-cell-16-8"></a>        sink<span class="op">(</span>v<span class="op">,</span> i<span class="op">-</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="annotated-cell-16-9"><a href="#annotated-cell-16-9"></a>    <span class="op">}</span></span>
<span id="annotated-cell-16-10"><a href="#annotated-cell-16-10"></a><span class="op">}</span></span>
<span id="annotated-cell-16-11"><a href="#annotated-cell-16-11"></a></span>
<span id="annotated-cell-16-12"><a href="#annotated-cell-16-12"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> Elem<span class="op">&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-16" data-target-annotation="4">4</button><span id="annotated-cell-16-13" class="code-annotation-target"><a href="#annotated-cell-16-13"></a><span class="dt">void</span> make_heap<span class="op">(</span>Elem v<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="annotated-cell-16-14"><a href="#annotated-cell-16-14"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> n<span class="op">/</span><span class="dv">2</span><span class="op">;</span> i <span class="op">&gt;</span> <span class="dv">0</span><span class="op">;</span> <span class="op">--</span>i<span class="op">)</span></span>
<span id="annotated-cell-16-15"><a href="#annotated-cell-16-15"></a>        sink<span class="op">(</span>v<span class="op">,</span> n<span class="op">,</span> i<span class="op">);</span></span>
<span id="annotated-cell-16-16"><a href="#annotated-cell-16-16"></a><span class="op">}</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-16" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-16" data-code-lines="4" data-code-annotation="1">Sorts v[1..n] in ascending order (v[0] is unused)</span>
</dd>
<dt data-target-cell="annotated-cell-16" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-16" data-code-lines="7" data-code-annotation="2">extract largest element from the heap</span>
</dd>
<dt data-target-cell="annotated-cell-16" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-16" data-code-lines="8" data-code-annotation="3">sink the root to re-establish max-heap order in the subarray v[1..i-1]</span>
</dd>
<dt data-target-cell="annotated-cell-16" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-16" data-code-lines="13" data-code-annotation="4"><code>make_heap</code> establishes a (max) heap order in the array v[1..n] of Elem’s; Elem == priorities this is a.k.a. as <em>heapify</em></span>
</dd>
</dl>
</section>
<section id="worst-case-cost-of-make_heap" class="slide level2">
<h2>Worst case cost of <code>make_heap</code></h2>
<div class="sourceCode" id="annotated-cell-17"><pre class="sourceCode numberSource cpp code-annotation-code number-lines code-with-copy"><code class="sourceCode cpp"><span id="annotated-cell-17-1"><a href="#annotated-cell-17-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> Elem<span class="op">&gt;</span></span>
<span id="annotated-cell-17-2"><a href="#annotated-cell-17-2"></a><span class="dt">void</span> make_heap<span class="op">(</span>Elem v<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="annotated-cell-17-3"><a href="#annotated-cell-17-3"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> n<span class="op">/</span><span class="dv">2</span><span class="op">;</span> i <span class="op">&gt;</span> <span class="dv">0</span><span class="op">;</span> <span class="op">--</span>i<span class="op">)</span></span>
<span id="annotated-cell-17-4"><a href="#annotated-cell-17-4"></a>        sink<span class="op">(</span>v<span class="op">,</span> n<span class="op">,</span> i<span class="op">);</span></span>
<span id="annotated-cell-17-5"><a href="#annotated-cell-17-5"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Let <span class="math inline">B(n)</span> be the worst-case cost of <code>make_heap</code>. Since the worst-case cost of <code>sink(v,i-1,j)</code> is <span class="math inline">\mathcal O(\log i)</span>. We have <span class="math display">
\begin{align*}
B(n)&amp;=\sum_{i=1}^{n/2} \mathcal O(\log n)=\mathcal O(n\log n)
\end{align*}
</span></p>
</section>
<section id="worst-case-cost-of-heapsort" class="slide level2">
<h2>Worst-case cost of <code>heapsort</code></h2>
<div class="sourceCode" id="annotated-cell-18"><pre class="sourceCode numberSource cpp code-annotation-code number-lines code-with-copy"><code class="sourceCode cpp"><span id="annotated-cell-18-1"><a href="#annotated-cell-18-1"></a><span class="dt">void</span> heapsort<span class="op">(</span>Elem v<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="annotated-cell-18-2"><a href="#annotated-cell-18-2"></a>    make_heap<span class="op">(</span>v<span class="op">,</span> n<span class="op">);</span></span>
<span id="annotated-cell-18-3"><a href="#annotated-cell-18-3"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> n<span class="op">;</span> i <span class="op">&gt;</span> <span class="dv">0</span><span class="op">;</span> <span class="op">--</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="annotated-cell-18-4"><a href="#annotated-cell-18-4"></a>        swap<span class="op">(</span>v<span class="op">[</span><span class="dv">1</span><span class="op">],</span> v<span class="op">[</span>i<span class="op">]);</span></span>
<span id="annotated-cell-18-5"><a href="#annotated-cell-18-5"></a>        sink<span class="op">(</span>v<span class="op">,</span> i<span class="op">-</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="annotated-cell-18-6"><a href="#annotated-cell-18-6"></a>    <span class="op">}</span></span>
<span id="annotated-cell-18-7"><a href="#annotated-cell-18-7"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The worst case cost of <code>heapsort</code> <span class="math inline">H(n)</span> is <span class="math display">
\begin{align*}
H(n)&amp;=B(n)+  \sum_{i=1}^{n}\mathcal O(\log i)
\\
&amp;=\mathcal O(n\log n)+ \mathcal O(\log n!)
\\
&amp;=\mathcal O(n\log n)
\end{align*}
</span></p>
</section>
<section id="section-4" class="slide level2">
<h2></h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource cpp number-lines code-with-copy"><code class="sourceCode cpp"><span id="cb15-1"><a href=""></a><span class="co">//Heapsort using priority_queue as a blackbox</span></span>
<span id="cb15-2"><a href=""></a><span class="pp">#include</span><span class="im">&lt;queue&gt;</span></span>
<span id="cb15-3"><a href=""></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb15-4"><a href=""></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> elem<span class="op">&gt;</span></span>
<span id="cb15-5"><a href=""></a><span class="dt">void</span> heap_sort <span class="op">(</span>vector<span class="op">&lt;</span>elem<span class="op">&gt;&amp;</span> v<span class="op">)</span> <span class="op">{</span></span>
<span id="cb15-6"><a href=""></a>    <span class="dt">int</span> n <span class="op">=</span> v<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb15-7"><a href=""></a>    priority_queue<span class="op">&lt;</span>elem<span class="op">&gt;</span> pq<span class="op">;</span></span>
<span id="cb15-8"><a href=""></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> </span>
<span id="cb15-9"><a href=""></a>        pq<span class="op">.</span>push<span class="op">(</span>v<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb15-10"><a href=""></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> n<span class="op">-</span><span class="dv">1</span><span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> <span class="op">--</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb15-11"><a href=""></a>        v<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> pq<span class="op">.</span>top<span class="op">();</span></span>
<span id="cb15-12"><a href=""></a>        pq<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb15-13"><a href=""></a>    <span class="op">}</span> </span>
<span id="cb15-14"><a href=""></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A possible visualization of <a href="https://www.cs.usfca.edu/~galles/visualization/HeapSort.html">heapsort</a>.</p>
</section>
<section id="worst-case-cost-of-make_heap-a-better-analysis" class="slide level2">
<h2>Worst-case cost of <code>make_heap</code> — <em>a better analysis</em></h2>
<div class="sourceCode" id="annotated-cell-20"><pre class="sourceCode numberSource cpp code-annotation-code number-lines code-with-copy"><code class="sourceCode cpp"><span id="annotated-cell-20-1"><a href="#annotated-cell-20-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> Elem<span class="op">&gt;</span></span>
<span id="annotated-cell-20-2"><a href="#annotated-cell-20-2"></a><span class="dt">void</span> make_heap<span class="op">(</span>Elem v<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="annotated-cell-20-3"><a href="#annotated-cell-20-3"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> n<span class="op">/</span><span class="dv">2</span><span class="op">;</span> i <span class="op">&gt;</span> <span class="dv">0</span><span class="op">;</span> <span class="op">--</span>i<span class="op">)</span></span>
<span id="annotated-cell-20-4"><a href="#annotated-cell-20-4"></a>        sink<span class="op">(</span>v<span class="op">,</span> n<span class="op">,</span> i<span class="op">);</span></span>
<span id="annotated-cell-20-5"><a href="#annotated-cell-20-5"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Let <span class="math inline">B(n)</span> be the worst-case cost of <code>make_heap</code>. We have</p>
<p><span class="math display">
B(n)=\Theta(n)\ .
</span></p>
<p>(see blackboard)</p>
<p>This, of course, does not change the cost of <code>heapsort</code> but it is still useful.</p>
</section>
<section id="k-th-smallest-elements" class="slide level2">
<h2><span class="math inline">k</span>-th smallest elements</h2>
<p>Suppose that given a vector with <span class="math inline">n</span> elements we don’t want to completely order it, but say we only want to output in increasing order, for example the <span class="math inline">k</span> smallest elements.</p>
<p>Using a min-heap to store the elements and getting the minimum <span class="math inline">k</span> times, we can get the <span class="math inline">k</span> smallest elements in ascending order with cost <span class="math display">
B(n)+\mathcal O(k\log n)=\mathcal O(n+k\log n)\ .
</span></p>
<p>Which means <span class="math inline">\mathcal O(n)</span> if <span class="math inline">k=\mathcal O(n/\log n)</span>.</p>
</section>
<section id="upcoming-classes" class="slide level2">
<h2>Upcoming classes</h2>
<dl>
<dt>Wednesday</dt>
<dd>
Problem class P4 on dictionaries (<span class="alert">do the exercises before class</span>).
</dd>
<dt>Next Monday</dt>
<dd>
Theory class T7 on <span class="def">Graphs</span>!
</dd>
</dl>
<p><br> <br> <br> <span class="green"><strong>Questions?</strong></span></p>

</section></section>

    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="T6-slides_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="T6-slides_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="T6-slides_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="T6-slides_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="T6-slides_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="T6-slides_files/libs/revealjs/plugin/reveal-attribution/attribution.js"></script>
  <script src="T6-slides_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="T6-slides_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="T6-slides_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="T6-slides_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":false},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealAttribution, QuartoSupport,

          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script type="ojs-module-contents">
    eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImQzID0gcmVxdWlyZShcImQzLXNlbGVjdGlvbkAxLjRcIiwgXCJkMy10cmFuc2l0aW9uQDEuM1wiLCBcImQzLWVhc2VcIiwgXCJkMy1pbnRlcnBvbGF0ZVwiLCBcImQzLXNjYWxlLWNocm9tYXRpY0AxLjVcIilcbmV3aWR0aCA9IE1hdGgubWluKHdpZHRoLCA2NDApXG5kdXIgPSAyMDAwXG5yb290ID0gZDMuc2NoZW1lQ2F0ZWdvcnkxMFswXVxucGl2b3QgPSBkMy5zY2hlbWVDYXRlZ29yeTEwWzFdXG5zZWNvbmRhcnkgPSBkMy5zY2hlbWVDYXRlZ29yeTEwWzRdXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJodG1sYDxmaWd1cmU+PHN2ZyB3aWR0aD0ke2V3aWR0aH0gaGVpZ2h0PVwiNDIwXCI+XG4gICAgPGxpbmUgY2xhc3M9XCJlZGdlXCIgaWQ9XCJlNTRcIiB4MT1cIiR7ZXdpZHRoLzJ9XCIgeTE9XCI1MFwiIHgyPVwiJHtld2lkdGgvNH1cIiB5Mj1cIjE1MFwiIHN0cm9rZT1cImJsYWNrXCIgLz5cbiAgICA8bGluZSBjbGFzcz1cImVkZ2VcIiBpZD1cImU1N1wiIHgxPVwiJHtld2lkdGgvMn1cIiB5MT1cIjUwXCIgeDI9XCIkezMqZXdpZHRoLzR9XCIgeTI9XCIxNTBcIiBzdHJva2U9XCJibGFja1wiIC8+XG4gICAgPGxpbmUgY2xhc3M9XCJlZGdlXCIgaWQ9XCJlNDJcIiB4MT1cIiR7ZXdpZHRoLzR9XCIgeTE9XCIxNTBcIiB4Mj1cIiR7ZXdpZHRoLzh9XCIgeTI9XCIyNTBcIiBzdHJva2U9XCJibGFja1wiIC8+XG4gICAgPGxpbmUgY2xhc3M9XCJlZGdlXCIgaWQ9XCJlNzZcIiB4MT1cIiR7Mypld2lkdGgvNH1cIiB5MT1cIjE1MFwiIHgyPVwiJHs1KmV3aWR0aC84fVwiIHkyPVwiMjUwXCIgc3Ryb2tlPVwiYmxhY2tcIiAvPlxuICAgIDxsaW5lIGNsYXNzPVwiZWRnZVwiIGlkPVwiZTc4XCIgeDE9XCIkezMqZXdpZHRoLzR9XCIgeTE9XCIxNTBcIiB4Mj1cIiR7Nypld2lkdGgvOH1cIiB5Mj1cIjI1MFwiIHN0cm9rZT1cImJsYWNrXCIgLz5cbiAgICA8bGluZSBjbGFzcz1cImVkZ2VcIiBpZD1cImUyM1wiIHgxPVwiJHtld2lkdGgvOH1cIiB5MT1cIjI1MFwiIHgyPVwiJHszKmV3aWR0aC8xNn1cIiB5Mj1cIjM1MFwiIHN0cm9rZT1cImJsYWNrXCIgLz5cblxuICAgIDxnIGNsYXNzPVwibm9kZVwiIGlkPVwibjVcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoJHtld2lkdGgvMn0sIDUwKVwiPlxuICAgICAgPGNpcmNsZSByPVwiMzVcIiBmaWxsPVwid2hpdGVcIiBzdHJva2U9XCJibGFja1wiPjwvY2lyY2xlPlxuICAgICAgPHRleHQgZmlsbD1cImJsYWNrXCIgdGV4dC1hbmNob3I9XCJtaWRkbGVcIiBhbGlnbm1lbnQtYmFzZWxpbmU9XCJjZW50cmFsXCI+NTwvdGV4dD5cbiAgICAgIDx0ZXh0IGZpbGw9XCIjQzAwXCIgdHJhbnNmb3JtPVwidHJhbnNsYXRlKDMsIDI1KVwiIGFsaWdubWVudC1iYXNlbGluZT1cImhhbmdpbmdcIj4tMTwvdGV4dD5cbiAgICA8L2c+XG4gICAgPGcgY2xhc3M9XCJub2RlXCIgaWQ9XCJuNFwiIHRyYW5zZm9ybT1cInRyYW5zbGF0ZSgke2V3aWR0aC80fSwgMTUwKVwiPlxuICAgICAgPGNpcmNsZSByPVwiMzVcIiBmaWxsPVwiJHtyb290fVwiIHN0cm9rZT1cImJsYWNrXCI+PC9jaXJjbGU+XG4gICAgICA8dGV4dCBmaWxsPVwid2hpdGVcIiB0ZXh0LWFuY2hvcj1cIm1pZGRsZVwiIGFsaWdubWVudC1iYXNlbGluZT1cImNlbnRyYWxcIj40PC90ZXh0PlxuICAgICAgPHRleHQgZmlsbD1cIiNDMDBcIiBmb250LXdlaWdodD1cImJvbGRcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoMywgMjUpXCIgYWxpZ25tZW50LWJhc2VsaW5lPVwiaGFuZ2luZ1wiPi0yPC90ZXh0PlxuICAgIDwvZz5cbiAgICA8ZyBjbGFzcz1cIm5vZGVcIiBpZD1cIm43XCIgdHJhbnNmb3JtPVwidHJhbnNsYXRlKCR7Mypld2lkdGgvNH0sIDE1MClcIj5cbiAgICAgIDxjaXJjbGUgcj1cIjM1XCIgZmlsbD1cIndoaXRlXCIgc3Ryb2tlPVwiYmxhY2tcIj48L2NpcmNsZT5cbiAgICAgIDx0ZXh0IGZpbGw9XCJibGFja1wiIHRleHQtYW5jaG9yPVwibWlkZGxlXCIgYWxpZ25tZW50LWJhc2VsaW5lPVwiY2VudHJhbFwiPjc8L3RleHQ+XG4gICAgICA8dGV4dCBmaWxsPVwiI2JsYWNrXCIgdHJhbnNmb3JtPVwidHJhbnNsYXRlKDMsIDI1KVwiIGFsaWdubWVudC1iYXNlbGluZT1cImhhbmdpbmdcIj4wPC90ZXh0PlxuICAgIDwvZz5cbiAgICA8ZyBjbGFzcz1cIm5vZGVcIiBpZD1cIm4yXCIgdHJhbnNmb3JtPVwidHJhbnNsYXRlKCR7ZXdpZHRoLzh9LCAyNTApXCI+XG4gICAgICA8Y2lyY2xlIHI9XCIzNVwiIGZpbGw9XCJ3aGl0ZVwiIHN0cm9rZT1cImJsYWNrXCI+PC9jaXJjbGU+XG4gICAgICA8dGV4dCBmaWxsPVwiYmxhY2tcIiB0ZXh0LWFuY2hvcj1cIm1pZGRsZVwiIGFsaWdubWVudC1iYXNlbGluZT1cImNlbnRyYWxcIj4yPC90ZXh0PlxuICAgICAgPHRleHQgZmlsbD1cIiMwOTBcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoMTUsIDIwKVwiIGFsaWdubWVudC1iYXNlbGluZT1cImhhbmdpbmdcIj4rMTwvdGV4dD5cbiAgICA8L2c+XG4gICAgPGcgY2xhc3M9XCJub2RlXCIgaWQ9XCJuNlwiIHRyYW5zZm9ybT1cInRyYW5zbGF0ZSgkezUqZXdpZHRoLzh9LCAyNTApXCI+XG4gICAgICA8Y2lyY2xlIHI9XCIzNVwiIGZpbGw9XCJ3aGl0ZVwiIHN0cm9rZT1cImJsYWNrXCI+PC9jaXJjbGU+XG4gICAgICA8dGV4dCBmaWxsPVwiYmxhY2tcIiB0ZXh0LWFuY2hvcj1cIm1pZGRsZVwiIGFsaWdubWVudC1iYXNlbGluZT1cImNlbnRyYWxcIj42PC90ZXh0PlxuICAgICAgPHRleHQgZmlsbD1cImJsYWNrXCIgdHJhbnNmb3JtPVwidHJhbnNsYXRlKDMsIDI1KVwiIGFsaWdubWVudC1iYXNlbGluZT1cImhhbmdpbmdcIj4wPC90ZXh0PlxuICAgIDwvZz5cbiAgICA8ZyBjbGFzcz1cIm5vZGVcIiBpZD1cIm44XCIgdHJhbnNmb3JtPVwidHJhbnNsYXRlKCR7Nypld2lkdGgvOH0sIDI1MClcIj5cbiAgICAgIDxjaXJjbGUgcj1cIjM1XCIgZmlsbD1cIndoaXRlXCIgc3Ryb2tlPVwiYmxhY2tcIj48L2NpcmNsZT5cbiAgICAgIDx0ZXh0IGZpbGw9XCJibGFja1wiIHRleHQtYW5jaG9yPVwibWlkZGxlXCIgYWxpZ25tZW50LWJhc2VsaW5lPVwiY2VudHJhbFwiPjg8L3RleHQ+XG4gICAgICA8dGV4dCBmaWxsPVwiYmxhY2tcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoMywgMjUpXCIgYWxpZ25tZW50LWJhc2VsaW5lPVwiaGFuZ2luZ1wiPjA8L3RleHQ+XG4gICAgPC9nPlxuICAgIDxnIGNsYXNzPVwibm9kZVwiIGlkPVwibjNcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoJHszKmV3aWR0aC8xNn0sIDM1MClcIj5cbiAgICAgIDxjaXJjbGUgcj1cIjM1XCIgZmlsbD1cIndoaXRlXCIgc3Ryb2tlPVwiYmxhY2tcIj48L2NpcmNsZT5cbiAgICAgIDx0ZXh0IGZpbGw9XCJibGFja1wiIHRleHQtYW5jaG9yPVwibWlkZGxlXCIgYWxpZ25tZW50LWJhc2VsaW5lPVwiY2VudHJhbFwiPjM8L3RleHQ+XG4gICAgICA8dGV4dCBmaWxsPVwiYmxhY2tcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoMywgMjUpXCIgYWxpZ25tZW50LWJhc2VsaW5lPVwiaGFuZ2luZ1wiPjA8L3RleHQ+XG4gICAgPC9nPlxuICA8L3N2Zz5cbjwvZmlndXJlPmBcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgY29uc3QgdmlldyA9IGh0bWxgPGZpZ3VyZT48c3ZnIHdpZHRoPSR7ZXdpZHRofSBoZWlnaHQ9XCI0NTJcIj5cbiAgICA8bGluZSBjbGFzcz1cImVkZ2VcIiBpZD1cImUxMlwiIHgxPVwiJHtld2lkdGgvMn1cIiB5MT1cIjUwXCIgeDI9XCIke2V3aWR0aC80fVwiIHkyPVwiMTUwXCIgc3Ryb2tlPVwiYmxhY2tcIiAvPlxuICAgIDxsaW5lIGNsYXNzPVwiZWRnZVwiIGlkPVwiZTEzXCIgeDE9XCIke2V3aWR0aC8yfVwiIHkxPVwiNTBcIiB4Mj1cIiR7Mypld2lkdGgvNH1cIiB5Mj1cIjE1MFwiIHN0cm9rZT1cImJsYWNrXCIgLz5cbiAgICA8bGluZSBjbGFzcz1cImVkZ2VcIiBpZD1cImUyNFwiIHgxPVwiJHtld2lkdGgvNH1cIiB5MT1cIjE1MFwiIHgyPVwiJHtld2lkdGgvOH1cIiB5Mj1cIjI1MFwiIHN0cm9rZT1cImJsYWNrXCIgLz5cbiAgICA8bGluZSBjbGFzcz1cImVkZ2VcIiBpZD1cImUyNVwiIHgxPVwiJHtld2lkdGgvNH1cIiB5MT1cIjE1MFwiIHgyPVwiJHszKmV3aWR0aC84fVwiIHkyPVwiMjUwXCIgc3Ryb2tlPVwiYmxhY2tcIiAvPlxuXG4gICAgPGcgY2xhc3M9XCJub2RlXCIgaWQ9XCJuMVwiIHRyYW5zZm9ybT1cInRyYW5zbGF0ZSgke2V3aWR0aC8yfSwgNTApXCI+XG4gICAgICA8Y2lyY2xlIHI9XCIzNVwiIGZpbGw9XCIke3Jvb3R9XCIgc3Ryb2tlPVwiYmxhY2tcIj48L2NpcmNsZT5cbiAgICAgIDx0ZXh0IGNsYXNzPVwidmFsdWVcIiBmaWxsPVwid2hpdGVcIiB0ZXh0LWFuY2hvcj1cIm1pZGRsZVwiIGFsaWdubWVudC1iYXNlbGluZT1cImNlbnRyYWxcIj5yb290PC90ZXh0PlxuICAgICAgPHRleHQgY2xhc3M9XCJiYWxhbmNlXCIgZmlsbD1cIiNDMDBcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoMywgMjUpXCIgYWxpZ25tZW50LWJhc2VsaW5lPVwiaGFuZ2luZ1wiIHN0eWxlPVwiZm9udC13ZWlnaHQ6Ym9sZFwiPi0yPC90ZXh0PlxuICAgIDwvZz5cbiAgICA8ZyBjbGFzcz1cIm5vZGVcIiBpZD1cIm4yXCIgdHJhbnNmb3JtPVwidHJhbnNsYXRlKCR7ZXdpZHRoLzR9LCAxNTApXCI+XG4gICAgICA8Y2lyY2xlIHI9XCIzNVwiIGZpbGw9XCIke3Bpdm90fVwiIHN0cm9rZT1cImJsYWNrXCI+PC9jaXJjbGU+XG4gICAgICA8dGV4dCBjbGFzcz1cInZhbHVlXCIgZmlsbD1cIndoaXRlXCIgdGV4dC1hbmNob3I9XCJtaWRkbGVcIiBhbGlnbm1lbnQtYmFzZWxpbmU9XCJjZW50cmFsXCI+cGl2b3Q8L3RleHQ+XG4gICAgICA8dGV4dCBjbGFzcz1cImJhbGFuY2VcIiBmaWxsPVwiI0MwMFwiIHRyYW5zZm9ybT1cInRyYW5zbGF0ZSgzLCAyNSlcIiBhbGlnbm1lbnQtYmFzZWxpbmU9XCJoYW5naW5nXCI+LTE8L3RleHQ+XG4gICAgPC9nPlxuICAgIDxnIGNsYXNzPVwibm9kZVwiIGlkPVwibjNcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoJHszKmV3aWR0aC80fSwgMTUwKVwiPlxuICAgICAgPHBvbHlnb24gcG9pbnRzPVwiMCwgMCAyNSwgMTAwIC0yNSwgMTAwXCIgZmlsbD1cIndoaXRlXCIgc3Ryb2tlPVwiYmxhY2tcIiAvPlxuICAgICAgPHRleHQgZmlsbD1cImJsYWNrXCIgeT1cIjUwXCIgdGV4dC1hbmNob3I9XCJtaWRkbGVcIiBhbGlnbm1lbnQtYmFzZWxpbmU9XCJjZW50cmFsXCI+aDwvdGV4dD5cbiAgICA8L2c+XG4gICAgPGcgY2xhc3M9XCJub2RlXCIgaWQ9XCJuNFwiIHRyYW5zZm9ybT1cInRyYW5zbGF0ZSgke2V3aWR0aC84fSwgMjUwKVwiPlxuICAgICAgPHBvbHlnb24gcG9pbnRzPVwiMCwgMCAyNSwgMTAwIC0yNSwgMTAwXCIgZmlsbD1cIndoaXRlXCIgc3Ryb2tlPVwiYmxhY2tcIiAvPlxuICAgICAgPHRleHQgZmlsbD1cImJsYWNrXCIgeT1cIjUwXCIgdGV4dC1hbmNob3I9XCJtaWRkbGVcIiBhbGlnbm1lbnQtYmFzZWxpbmU9XCJjZW50cmFsXCI+aDwvdGV4dD5cbiAgICAgIDxsaW5lIHgxPVwiMFwiIHkxPVwiMTAwXCIgeDI9XCIwXCIgeTI9XCIxNzVcIiBzdHJva2U9XCJibGFja1wiIHN0cm9rZS1kYXNoYXJyYXk9XCI0XCIgLz5cbiAgICAgIDxjaXJjbGUgY3k9XCIxNzVcIiByPVwiMTBcIiBzdHJva2UtZGFzaGFycmF5PVwiNFwiIGZpbGw9XCJ3aGl0ZVwiIHN0cm9rZT1cImJsYWNrXCI+PC9jaXJjbGU+XG4gICAgPC9nPlxuICAgIDxnIGNsYXNzPVwibm9kZVwiIGlkPVwibjVcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoJHszKmV3aWR0aC84fSwgMjUwKVwiPlxuICAgICAgPHBvbHlnb24gcG9pbnRzPVwiMCwgMCAyNSwgMTAwIC0yNSwgMTAwXCIgZmlsbD1cIndoaXRlXCIgc3Ryb2tlPVwiYmxhY2tcIiAvPlxuICAgICAgPHRleHQgZmlsbD1cImJsYWNrXCIgeT1cIjUwXCIgdGV4dC1hbmNob3I9XCJtaWRkbGVcIiBhbGlnbm1lbnQtYmFzZWxpbmU9XCJjZW50cmFsXCI+aDwvdGV4dD5cbiAgICA8L2c+XG4gPC9zdmc+XG48L2ZpZ3VyZT5gO1xuICBcbiAgY29uc3QgdHJlZV92aWV3ID0gZDMuc2VsZWN0KHZpZXcpO1xuICB2YXIgdCA9IGQzLnRyYW5zaXRpb24oKTtcbiAgXG4gIHRyZWVfdmlldy5zZWxlY3QoXCIjZTEyXCIpLnRyYW5zaXRpb24odClcbiAgICAuZGVsYXkoMTAwMClcbiAgICAub24oXCJzdGFydFwiLCBmdW5jdGlvbiByZXBlYXQoKSB7XG4gICAgICBkMy5hY3RpdmUodGhpcylcbiAgICAgICAgICAuZHVyYXRpb24oZHVyKVxuICAgICAgICAgIC5hdHRyKFwieDFcIiwgMypld2lkdGgvNClcbiAgICAgICAgICAuYXR0cihcInkxXCIsIDE1MClcbiAgICAgICAgICAuYXR0cihcIngyXCIsIGV3aWR0aC8yKVxuICAgICAgICAgIC5hdHRyKFwieTJcIiwgNTApXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5kdXJhdGlvbigwKVxuICAgICAgICAgIC5hdHRyKFwieDFcIiwgZXdpZHRoLzIpXG4gICAgICAgICAgLmF0dHIoXCJ5MVwiLCA1MClcbiAgICAgICAgICAuYXR0cihcIngyXCIsIGV3aWR0aC80KVxuICAgICAgICAgIC5hdHRyKFwieTJcIiwgMTUwKVxuICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmRlbGF5KGR1cilcbiAgICAgICAgICAub24oXCJzdGFydFwiLCByZXBlYXQpO1xuICB9KTtcbiAgdHJlZV92aWV3LnNlbGVjdChcIiNlMTNcIikudHJhbnNpdGlvbih0KVxuICAgIC5kZWxheSgxMDAwKVxuICAgIC5vbihcInN0YXJ0XCIsIGZ1bmN0aW9uIHJlcGVhdCgpIHtcbiAgICAgIGQzLmFjdGl2ZSh0aGlzKVxuICAgICAgICAgIC5kdXJhdGlvbihkdXIpXG4gICAgICAgICAgLmF0dHIoXCJ4MVwiLCAzKmV3aWR0aC80KVxuICAgICAgICAgIC5hdHRyKFwieTFcIiwgMTUwKVxuICAgICAgICAgIC5hdHRyKFwieDJcIiwgNypld2lkdGgvOClcbiAgICAgICAgICAuYXR0cihcInkyXCIsIDI1MClcbiAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLmR1cmF0aW9uKDApXG4gICAgICAgICAgLmF0dHIoXCJ4MVwiLCBld2lkdGgvMilcbiAgICAgICAgICAuYXR0cihcInkxXCIsIDUwKVxuICAgICAgICAgIC5hdHRyKFwieDJcIiwgMypld2lkdGgvNClcbiAgICAgICAgICAuYXR0cihcInkyXCIsIDE1MClcbiAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLm9uKFwic3RhcnRcIiwgcmVwZWF0KTtcbiAgfSk7XG4gIHRyZWVfdmlldy5zZWxlY3QoXCIjZTI0XCIpLnRyYW5zaXRpb24odClcbiAgICAuZGVsYXkoMTAwMClcbiAgICAub24oXCJzdGFydFwiLCBmdW5jdGlvbiByZXBlYXQoKSB7XG4gICAgICBkMy5hY3RpdmUodGhpcylcbiAgICAgICAgICAuZHVyYXRpb24oZHVyKVxuICAgICAgICAgIC5hdHRyKFwieDFcIiwgZXdpZHRoLzIpXG4gICAgICAgICAgLmF0dHIoXCJ5MVwiLCA1MClcbiAgICAgICAgICAuYXR0cihcIngyXCIsIGV3aWR0aC80KVxuICAgICAgICAgIC5hdHRyKFwieTJcIiwgMTUwKVxuICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmRlbGF5KGR1cilcbiAgICAgICAgICAuZHVyYXRpb24oMClcbiAgICAgICAgICAuYXR0cihcIngxXCIsIGV3aWR0aC80KVxuICAgICAgICAgIC5hdHRyKFwieTFcIiwgMTUwKVxuICAgICAgICAgIC5hdHRyKFwieDJcIiwgZXdpZHRoLzgpXG4gICAgICAgICAgLmF0dHIoXCJ5MlwiLCAyNTApXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5vbihcInN0YXJ0XCIsIHJlcGVhdCk7XG4gIH0pO1xuICB0cmVlX3ZpZXcuc2VsZWN0KFwiI2UyNVwiKS50cmFuc2l0aW9uKHQpXG4gICAgLmRlbGF5KDEwMDApXG4gICAgLm9uKFwic3RhcnRcIiwgZnVuY3Rpb24gcmVwZWF0KCkge1xuICAgICAgZDMuYWN0aXZlKHRoaXMpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgICAuYXR0cihcIngxXCIsIDMqZXdpZHRoLzQpXG4gICAgICAgICAgLmF0dHIoXCJ5MVwiLCAxNTApXG4gICAgICAgICAgLmF0dHIoXCJ4MlwiLCA1KmV3aWR0aC84KVxuICAgICAgICAgIC5hdHRyKFwieTJcIiwgMjUwKVxuICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmRlbGF5KGR1cilcbiAgICAgICAgICAuZHVyYXRpb24oMClcbiAgICAgICAgICAuYXR0cihcIngxXCIsIGV3aWR0aC80KVxuICAgICAgICAgIC5hdHRyKFwieTFcIiwgMTUwKVxuICAgICAgICAgIC5hdHRyKFwieDJcIiwgMypld2lkdGgvOClcbiAgICAgICAgICAuYXR0cihcInkyXCIsIDI1MClcbiAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLm9uKFwic3RhcnRcIiwgcmVwZWF0KTtcbiAgfSk7XG5cbiAgXG4gIHRyZWVfdmlldy5zZWxlY3QoXCIjbjFcIikudHJhbnNpdGlvbih0KVxuICAgIC5kZWxheSgxMDAwKVxuICAgIC5vbihcInN0YXJ0XCIsIGZ1bmN0aW9uIHJlcGVhdCgpIHtcbiAgICAgIGQzLmFjdGl2ZSh0aGlzKVxuICAgICAgICAgIC5kdXJhdGlvbihkdXIpXG4gICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyAoMypld2lkdGgvNCkgKyBcIiwgMTUwKVwiKVxuICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLmR1cmF0aW9uKDApXG4gICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyAoZXdpZHRoLzIpICsgXCIsIDUwKVwiKVxuICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmRlbGF5KGR1cilcbiAgICAgICAgICAub24oXCJzdGFydFwiLCByZXBlYXQpO1xuICB9KTtcbiAgdHJlZV92aWV3LnNlbGVjdChcIiNuMT4uYmFsYW5jZVwiKS50cmFuc2l0aW9uKHQpXG4gICAgLmRlbGF5KDEwMDApXG4gICAgLm9uKFwic3RhcnRcIiwgZnVuY3Rpb24gcmVwZWF0KCkge1xuICAgICAgZDMuYWN0aXZlKHRoaXMpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgICAudGV4dFR3ZWVuKCgpID0+ICgodCkgPT4gdCA8PSAwLjUgPyBcIi0yXCIgOiBcIjBcIikpXG4gICAgICAgICAgLnN0eWxlKFwiZmlsbFwiLCBcImJsYWNrXCIpXG4gICAgICAgICAgLnN0eWxlVHdlZW4oXCJmb250LXdlaWdodFwiLCAoKSA9PiAoKHQpID0+IHQgPD0gMC41ID8gXCJib2xkXCIgOlwibm9ybWFsXCIpKVxuICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLmR1cmF0aW9uKDApXG4gICAgICAgICAgLnRleHQoLTIpXG4gICAgICAgICAgLnN0eWxlKFwiZmlsbFwiLCBcIiNjMDBcIilcbiAgICAgICAgICAuc3R5bGUoXCJmb250LXdlaWdodFwiLCBcImJvbGRcIilcbiAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLm9uKFwic3RhcnRcIiwgcmVwZWF0KTtcbiAgfSk7XG4gIFxuICB0cmVlX3ZpZXcuc2VsZWN0KFwiI24yXCIpLnRyYW5zaXRpb24odClcbiAgICAuZGVsYXkoMTAwMClcbiAgICAub24oXCJzdGFydFwiLCBmdW5jdGlvbiByZXBlYXQoKSB7XG4gICAgICBkMy5hY3RpdmUodGhpcylcbiAgICAgICAgICAuZHVyYXRpb24oZHVyKVxuICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgKGV3aWR0aC8yKSArIFwiLCA1MClcIilcbiAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5kdXJhdGlvbigwKVxuICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgKGV3aWR0aC80KSArIFwiLCAxNTApXCIpXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5vbihcInN0YXJ0XCIsIHJlcGVhdCk7XG4gIH0pO1xuICB0cmVlX3ZpZXcuc2VsZWN0KFwiI24yPi5iYWxhbmNlXCIpLnRyYW5zaXRpb24odClcbiAgICAuZGVsYXkoMTAwMClcbiAgICAub24oXCJzdGFydFwiLCBmdW5jdGlvbiByZXBlYXQoKSB7XG4gICAgICBkMy5hY3RpdmUodGhpcylcbiAgICAgICAgICAuZHVyYXRpb24oZHVyKVxuICAgICAgICAgIC50ZXh0VHdlZW4oKCkgPT4gKCh0KSA9PiB0IDw9IDAuNSA/IFwiLTFcIiA6IFwiMFwiKSlcbiAgICAgICAgICAuc3R5bGUoXCJmaWxsXCIsIFwiYmxhY2tcIilcbiAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5kdXJhdGlvbigwKVxuICAgICAgICAgIC50ZXh0KFwiLTFcIilcbiAgICAgICAgICAuc3R5bGUoXCJmaWxsXCIsIFwiI2MwMFwiKVxuICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmRlbGF5KGR1cilcbiAgICAgICAgICAub24oXCJzdGFydFwiLCByZXBlYXQpO1xuICB9KTtcblxuICB0cmVlX3ZpZXcuc2VsZWN0KFwiI24zXCIpLnRyYW5zaXRpb24odClcbiAgICAuZGVsYXkoMTAwMClcbiAgICAub24oXCJzdGFydFwiLCBmdW5jdGlvbiByZXBlYXQoKSB7XG4gICAgICBkMy5hY3RpdmUodGhpcylcbiAgICAgICAgICAuZHVyYXRpb24oZHVyKVxuICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgKDcqZXdpZHRoLzgpICsgXCIsIDI1MClcIilcbiAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5kdXJhdGlvbigwKVxuICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgKDMqZXdpZHRoLzQpICsgXCIsIDE1MClcIilcbiAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLm9uKFwic3RhcnRcIiwgcmVwZWF0KTtcbiAgfSk7XG5cbiAgdHJlZV92aWV3LnNlbGVjdChcIiNuNFwiKS50cmFuc2l0aW9uKHQpXG4gICAgLmRlbGF5KDEwMDApXG4gICAgLm9uKFwic3RhcnRcIiwgZnVuY3Rpb24gcmVwZWF0KCkge1xuICAgICAgZDMuYWN0aXZlKHRoaXMpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIChld2lkdGgvNCkgKyBcIiwgMTUwKVwiKVxuICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLmR1cmF0aW9uKDApXG4gICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyAoZXdpZHRoLzgpICsgXCIsIDI1MClcIilcbiAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLm9uKFwic3RhcnRcIiwgcmVwZWF0KTtcbiAgfSk7XG5cbiAgdHJlZV92aWV3LnNlbGVjdChcIiNuNVwiKS50cmFuc2l0aW9uKHQpXG4gICAgLmRlbGF5KDEwMDApXG4gICAgLm9uKFwic3RhcnRcIiwgZnVuY3Rpb24gcmVwZWF0KCkge1xuICAgICAgZDMuYWN0aXZlKHRoaXMpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArICg1KmV3aWR0aC84KSArIFwiLCAyNTApXCIpXG4gICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmRlbGF5KGR1cilcbiAgICAgICAgICAuZHVyYXRpb24oMClcbiAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArICgzKmV3aWR0aC84KSArIFwiLCAyNTApXCIpXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5vbihcInN0YXJ0XCIsIHJlcGVhdCk7XG4gIH0pO1xuICBcbiAgcmV0dXJuIHZpZXc7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ7XG4gIGNvbnN0IHZpZXcgPSBodG1sYDxmaWd1cmU+PHN2ZyB3aWR0aD0ke2V3aWR0aH0gaGVpZ2h0PVwiNDUyXCI+XG4gICAgPGxpbmUgY2xhc3M9XCJlZGdlXCIgaWQ9XCJlMTJcIiB4MT1cIiR7ZXdpZHRoLzJ9XCIgeTE9XCI1MFwiIHgyPVwiJHszKmV3aWR0aC80fVwiIHkyPVwiMTUwXCIgc3Ryb2tlPVwiYmxhY2tcIiAvPlxuICAgIDxsaW5lIGNsYXNzPVwiZWRnZVwiIGlkPVwiZTEzXCIgeDE9XCIke2V3aWR0aC8yfVwiIHkxPVwiNTBcIiB4Mj1cIiR7ZXdpZHRoLzR9XCIgeTI9XCIxNTBcIiBzdHJva2U9XCJibGFja1wiIC8+XG4gICAgPGxpbmUgY2xhc3M9XCJlZGdlXCIgaWQ9XCJlMjRcIiB4MT1cIiR7Mypld2lkdGgvNH1cIiB5MT1cIjE1MFwiIHgyPVwiJHs3KmV3aWR0aC84fVwiIHkyPVwiMjUwXCIgc3Ryb2tlPVwiYmxhY2tcIiAvPlxuICAgIDxsaW5lIGNsYXNzPVwiZWRnZVwiIGlkPVwiZTI1XCIgeDE9XCIkezMqZXdpZHRoLzR9XCIgeTE9XCIxNTBcIiB4Mj1cIiR7NSpld2lkdGgvOH1cIiB5Mj1cIjI1MFwiIHN0cm9rZT1cImJsYWNrXCIgLz5cblxuICAgIDxnIGNsYXNzPVwibm9kZVwiIGlkPVwibjFcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoJHtld2lkdGgvMn0sIDUwKVwiPlxuICAgICAgPGNpcmNsZSByPVwiMzVcIiBmaWxsPVwiJHtyb290fVwiIHN0cm9rZT1cImJsYWNrXCI+PC9jaXJjbGU+XG4gICAgICA8dGV4dCBjbGFzcz1cInZhbHVlXCIgZmlsbD1cIndoaXRlXCIgdGV4dC1hbmNob3I9XCJtaWRkbGVcIiBhbGlnbm1lbnQtYmFzZWxpbmU9XCJjZW50cmFsXCI+cm9vdDwvdGV4dD5cbiAgICAgIDx0ZXh0IGNsYXNzPVwiYmFsYW5jZVwiIGZpbGw9XCIjMDkwXCIgdHJhbnNmb3JtPVwidHJhbnNsYXRlKDMsIDI1KVwiIGFsaWdubWVudC1iYXNlbGluZT1cImhhbmdpbmdcIiBzdHlsZT1cImZvbnQtd2VpZ2h0OmJvbGRcIj4rMjwvdGV4dD5cbiAgICA8L2c+XG4gICAgPGcgY2xhc3M9XCJub2RlXCIgaWQ9XCJuMlwiIHRyYW5zZm9ybT1cInRyYW5zbGF0ZSgkezMqZXdpZHRoLzR9LCAxNTApXCI+XG4gICAgICA8Y2lyY2xlIHI9XCIzNVwiIGZpbGw9XCIke3Bpdm90fVwiIHN0cm9rZT1cImJsYWNrXCI+PC9jaXJjbGU+XG4gICAgICA8dGV4dCBjbGFzcz1cInZhbHVlXCIgZmlsbD1cIndoaXRlXCIgdGV4dC1hbmNob3I9XCJtaWRkbGVcIiBhbGlnbm1lbnQtYmFzZWxpbmU9XCJjZW50cmFsXCI+cGl2b3Q8L3RleHQ+XG4gICAgICA8dGV4dCBjbGFzcz1cImJhbGFuY2VcIiBmaWxsPVwiIzA5MFwiIHRyYW5zZm9ybT1cInRyYW5zbGF0ZSgzLCAyNSlcIiBhbGlnbm1lbnQtYmFzZWxpbmU9XCJoYW5naW5nXCI+KzE8L3RleHQ+XG4gICAgPC9nPlxuICAgIDxnIGNsYXNzPVwibm9kZVwiIGlkPVwibjNcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoJHtld2lkdGgvNH0sIDE1MClcIj5cbiAgICAgIDxwb2x5Z29uIHBvaW50cz1cIjAsIDAgMjUsIDEwMCAtMjUsIDEwMFwiIGZpbGw9XCJ3aGl0ZVwiIHN0cm9rZT1cImJsYWNrXCIgLz5cbiAgICAgIDx0ZXh0IGZpbGw9XCJibGFja1wiIHk9XCI1MFwiIHRleHQtYW5jaG9yPVwibWlkZGxlXCIgYWxpZ25tZW50LWJhc2VsaW5lPVwiY2VudHJhbFwiPmg8L3RleHQ+XG4gICAgPC9nPlxuICAgIDxnIGNsYXNzPVwibm9kZVwiIGlkPVwibjRcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoJHs3KmV3aWR0aC84fSwgMjUwKVwiPlxuICAgICAgPHBvbHlnb24gcG9pbnRzPVwiMCwgMCAyNSwgMTAwIC0yNSwgMTAwXCIgZmlsbD1cIndoaXRlXCIgc3Ryb2tlPVwiYmxhY2tcIiAvPlxuICAgICAgPHRleHQgZmlsbD1cImJsYWNrXCIgeT1cIjUwXCIgdGV4dC1hbmNob3I9XCJtaWRkbGVcIiBhbGlnbm1lbnQtYmFzZWxpbmU9XCJjZW50cmFsXCI+aDwvdGV4dD5cbiAgICAgIDxsaW5lIHgxPVwiMFwiIHkxPVwiMTAwXCIgeDI9XCIwXCIgeTI9XCIxNzVcIiBzdHJva2U9XCJibGFja1wiIHN0cm9rZS1kYXNoYXJyYXk9XCI0XCIgLz5cbiAgICAgIDxjaXJjbGUgY3k9XCIxNzVcIiByPVwiMTBcIiBzdHJva2UtZGFzaGFycmF5PVwiNFwiIGZpbGw9XCJ3aGl0ZVwiIHN0cm9rZT1cImJsYWNrXCI+PC9jaXJjbGU+XG4gICAgPC9nPlxuICAgIDxnIGNsYXNzPVwibm9kZVwiIGlkPVwibjVcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoJHs1KmV3aWR0aC84fSwgMjUwKVwiPlxuICAgICAgPHBvbHlnb24gcG9pbnRzPVwiMCwgMCAyNSwgMTAwIC0yNSwgMTAwXCIgZmlsbD1cIndoaXRlXCIgc3Ryb2tlPVwiYmxhY2tcIiAvPlxuICAgICAgPHRleHQgZmlsbD1cImJsYWNrXCIgeT1cIjUwXCIgdGV4dC1hbmNob3I9XCJtaWRkbGVcIiBhbGlnbm1lbnQtYmFzZWxpbmU9XCJjZW50cmFsXCI+aDwvdGV4dD5cbiAgICA8L2c+XG4gPC9zdmc+XG4gIDwvZmlndXJlPmA7XG4gIFxuICBjb25zdCB0cmVlX3ZpZXcgPSBkMy5zZWxlY3Qodmlldyk7XG4gIHZhciB0ID0gZDMudHJhbnNpdGlvbigpO1xuICBcbiAgdHJlZV92aWV3LnNlbGVjdChcIiNlMTJcIikudHJhbnNpdGlvbih0KVxuICAgIC5kZWxheSgxMDAwKVxuICAgIC5vbihcInN0YXJ0XCIsIGZ1bmN0aW9uIHJlcGVhdCgpIHtcbiAgICAgIGQzLmFjdGl2ZSh0aGlzKVxuICAgICAgICAgIC5kdXJhdGlvbihkdXIpXG4gICAgICAgICAgLmF0dHIoXCJ4MVwiLCBld2lkdGgvNClcbiAgICAgICAgICAuYXR0cihcInkxXCIsIDE1MClcbiAgICAgICAgICAuYXR0cihcIngyXCIsIGV3aWR0aC8yKVxuICAgICAgICAgIC5hdHRyKFwieTJcIiwgNTApXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5kdXJhdGlvbigwKVxuICAgICAgICAgIC5hdHRyKFwieDFcIiwgZXdpZHRoLzIpXG4gICAgICAgICAgLmF0dHIoXCJ5MVwiLCA1MClcbiAgICAgICAgICAuYXR0cihcIngyXCIsIDMqZXdpZHRoLzQpXG4gICAgICAgICAgLmF0dHIoXCJ5MlwiLCAxNTApXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5vbihcInN0YXJ0XCIsIHJlcGVhdCk7XG4gIH0pO1xuICB0cmVlX3ZpZXcuc2VsZWN0KFwiI2UxM1wiKS50cmFuc2l0aW9uKHQpXG4gICAgLmRlbGF5KDEwMDApXG4gICAgLm9uKFwic3RhcnRcIiwgZnVuY3Rpb24gcmVwZWF0KCkge1xuICAgICAgZDMuYWN0aXZlKHRoaXMpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgICAuYXR0cihcIngxXCIsIGV3aWR0aC80KVxuICAgICAgICAgIC5hdHRyKFwieTFcIiwgMTUwKVxuICAgICAgICAgIC5hdHRyKFwieDJcIiwgZXdpZHRoLzgpXG4gICAgICAgICAgLmF0dHIoXCJ5MlwiLCAyNTApXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5kdXJhdGlvbigwKVxuICAgICAgICAgIC5hdHRyKFwieDFcIiwgZXdpZHRoLzIpXG4gICAgICAgICAgLmF0dHIoXCJ5MVwiLCA1MClcbiAgICAgICAgICAuYXR0cihcIngyXCIsIGV3aWR0aC80KVxuICAgICAgICAgIC5hdHRyKFwieTJcIiwgMTUwKVxuICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmRlbGF5KGR1cilcbiAgICAgICAgICAub24oXCJzdGFydFwiLCByZXBlYXQpO1xuICB9KTtcbiAgdHJlZV92aWV3LnNlbGVjdChcIiNlMjRcIikudHJhbnNpdGlvbih0KVxuICAgIC5kZWxheSgxMDAwKVxuICAgIC5vbihcInN0YXJ0XCIsIGZ1bmN0aW9uIHJlcGVhdCgpIHtcbiAgICAgIGQzLmFjdGl2ZSh0aGlzKVxuICAgICAgICAgIC5kdXJhdGlvbihkdXIpXG4gICAgICAgICAgLmF0dHIoXCJ4MVwiLCBld2lkdGgvMilcbiAgICAgICAgICAuYXR0cihcInkxXCIsIDUwKVxuICAgICAgICAgIC5hdHRyKFwieDJcIiwgMypld2lkdGgvNClcbiAgICAgICAgICAuYXR0cihcInkyXCIsIDE1MClcbiAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLmR1cmF0aW9uKDApXG4gICAgICAgICAgLmF0dHIoXCJ4MVwiLCAzKmV3aWR0aC80KVxuICAgICAgICAgIC5hdHRyKFwieTFcIiwgMTUwKVxuICAgICAgICAgIC5hdHRyKFwieDJcIiwgNypld2lkdGgvOClcbiAgICAgICAgICAuYXR0cihcInkyXCIsIDI1MClcbiAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLm9uKFwic3RhcnRcIiwgcmVwZWF0KTtcbiAgfSk7XG4gIHRyZWVfdmlldy5zZWxlY3QoXCIjZTI1XCIpLnRyYW5zaXRpb24odClcbiAgICAuZGVsYXkoMTAwMClcbiAgICAub24oXCJzdGFydFwiLCBmdW5jdGlvbiByZXBlYXQoKSB7XG4gICAgICBkMy5hY3RpdmUodGhpcylcbiAgICAgICAgICAuZHVyYXRpb24oZHVyKVxuICAgICAgICAgIC5hdHRyKFwieDFcIiwgZXdpZHRoLzQpXG4gICAgICAgICAgLmF0dHIoXCJ5MVwiLCAxNTApXG4gICAgICAgICAgLmF0dHIoXCJ4MlwiLCAzKmV3aWR0aC84KVxuICAgICAgICAgIC5hdHRyKFwieTJcIiwgMjUwKVxuICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmRlbGF5KGR1cilcbiAgICAgICAgICAuZHVyYXRpb24oMClcbiAgICAgICAgICAuYXR0cihcIngxXCIsIDMqZXdpZHRoLzQpXG4gICAgICAgICAgLmF0dHIoXCJ5MVwiLCAxNTApXG4gICAgICAgICAgLmF0dHIoXCJ4MlwiLCA1KmV3aWR0aC84KVxuICAgICAgICAgIC5hdHRyKFwieTJcIiwgMjUwKVxuICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmRlbGF5KGR1cilcbiAgICAgICAgICAub24oXCJzdGFydFwiLCByZXBlYXQpO1xuICB9KTtcblxuICBcbiAgdHJlZV92aWV3LnNlbGVjdChcIiNuMVwiKS50cmFuc2l0aW9uKHQpXG4gICAgLmRlbGF5KDEwMDApXG4gICAgLm9uKFwic3RhcnRcIiwgZnVuY3Rpb24gcmVwZWF0KCkge1xuICAgICAgZDMuYWN0aXZlKHRoaXMpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIChld2lkdGgvNCkgKyBcIiwgMTUwKVwiKVxuICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLmR1cmF0aW9uKDApXG4gICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyAoZXdpZHRoLzIpICsgXCIsIDUwKVwiKVxuICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmRlbGF5KGR1cilcbiAgICAgICAgICAub24oXCJzdGFydFwiLCByZXBlYXQpO1xuICB9KTtcbiAgdHJlZV92aWV3LnNlbGVjdChcIiNuMT4uYmFsYW5jZVwiKS50cmFuc2l0aW9uKHQpXG4gICAgLmRlbGF5KDEwMDApXG4gICAgLm9uKFwic3RhcnRcIiwgZnVuY3Rpb24gcmVwZWF0KCkge1xuICAgICAgZDMuYWN0aXZlKHRoaXMpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgICAudGV4dFR3ZWVuKCgpID0+ICgodCkgPT4gdCA8PSAwLjUgPyBcIisyXCIgOiBcIjBcIikpXG4gICAgICAgICAgLnN0eWxlKFwiZmlsbFwiLCBcImJsYWNrXCIpXG4gICAgICAgICAgLnN0eWxlVHdlZW4oXCJmb250LXdlaWdodFwiLCAoKSA9PiAoKHQpID0+IHQgPD0gMC41ID8gXCJib2xkXCIgOlwibm9ybWFsXCIpKVxuICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLmR1cmF0aW9uKDApXG4gICAgICAgICAgLnRleHQoXCIrMlwiKVxuICAgICAgICAgIC5zdHlsZShcImZpbGxcIiwgXCIjMDkwXCIpXG4gICAgICAgICAgLnN0eWxlKFwiZm9udC13ZWlnaHRcIiwgXCJib2xkXCIpXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5vbihcInN0YXJ0XCIsIHJlcGVhdCk7XG4gIH0pO1xuICBcbiAgdHJlZV92aWV3LnNlbGVjdChcIiNuMlwiKS50cmFuc2l0aW9uKHQpXG4gICAgLmRlbGF5KDEwMDApXG4gICAgLm9uKFwic3RhcnRcIiwgZnVuY3Rpb24gcmVwZWF0KCkge1xuICAgICAgZDMuYWN0aXZlKHRoaXMpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIChld2lkdGgvMikgKyBcIiwgNTApXCIpXG4gICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmRlbGF5KGR1cilcbiAgICAgICAgICAuZHVyYXRpb24oMClcbiAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArICgzKmV3aWR0aC80KSArIFwiLCAxNTApXCIpXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5vbihcInN0YXJ0XCIsIHJlcGVhdCk7XG4gIH0pO1xuICB0cmVlX3ZpZXcuc2VsZWN0KFwiI24yPi5iYWxhbmNlXCIpLnRyYW5zaXRpb24odClcbiAgICAuZGVsYXkoMTAwMClcbiAgICAub24oXCJzdGFydFwiLCBmdW5jdGlvbiByZXBlYXQoKSB7XG4gICAgICBkMy5hY3RpdmUodGhpcylcbiAgICAgICAgICAuZHVyYXRpb24oZHVyKVxuICAgICAgICAgIC50ZXh0VHdlZW4oKCkgPT4gKCh0KSA9PiB0IDw9IDAuNSA/IFwiKzFcIiA6IFwiMFwiKSlcbiAgICAgICAgICAuc3R5bGUoXCJmaWxsXCIsIFwiYmxhY2tcIilcbiAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5kdXJhdGlvbigwKVxuICAgICAgICAgIC50ZXh0KFwiKzFcIilcbiAgICAgICAgICAuc3R5bGUoXCJmaWxsXCIsIFwiIzA5MFwiKVxuICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmRlbGF5KGR1cilcbiAgICAgICAgICAub24oXCJzdGFydFwiLCByZXBlYXQpO1xuICB9KTtcblxuICB0cmVlX3ZpZXcuc2VsZWN0KFwiI24zXCIpLnRyYW5zaXRpb24odClcbiAgICAuZGVsYXkoMTAwMClcbiAgICAub24oXCJzdGFydFwiLCBmdW5jdGlvbiByZXBlYXQoKSB7XG4gICAgICBkMy5hY3RpdmUodGhpcylcbiAgICAgICAgICAuZHVyYXRpb24oZHVyKVxuICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgKCBld2lkdGgvOCkgKyBcIiwgMjUwKVwiKVxuICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLmR1cmF0aW9uKDApXG4gICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyAoZXdpZHRoLzQpICsgXCIsIDE1MClcIilcbiAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLm9uKFwic3RhcnRcIiwgcmVwZWF0KTtcbiAgfSk7XG5cbiAgdHJlZV92aWV3LnNlbGVjdChcIiNuNFwiKS50cmFuc2l0aW9uKHQpXG4gICAgLmRlbGF5KDEwMDApXG4gICAgLm9uKFwic3RhcnRcIiwgZnVuY3Rpb24gcmVwZWF0KCkge1xuICAgICAgZDMuYWN0aXZlKHRoaXMpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArICgzKmV3aWR0aC80KSArIFwiLCAxNTApXCIpXG4gICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmRlbGF5KGR1cilcbiAgICAgICAgICAuZHVyYXRpb24oMClcbiAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArICg3KmV3aWR0aC84KSArIFwiLCAyNTApXCIpXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5vbihcInN0YXJ0XCIsIHJlcGVhdCk7XG4gIH0pO1xuXG4gIHRyZWVfdmlldy5zZWxlY3QoXCIjbjVcIikudHJhbnNpdGlvbih0KVxuICAgIC5kZWxheSgxMDAwKVxuICAgIC5vbihcInN0YXJ0XCIsIGZ1bmN0aW9uIHJlcGVhdCgpIHtcbiAgICAgIGQzLmFjdGl2ZSh0aGlzKVxuICAgICAgICAgIC5kdXJhdGlvbihkdXIpXG4gICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyAoMypld2lkdGgvOCkgKyBcIiwgMjUwKVwiKVxuICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLmR1cmF0aW9uKDApXG4gICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyAoNSpld2lkdGgvOCkgKyBcIiwgMjUwKVwiKVxuICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmRlbGF5KGR1cilcbiAgICAgICAgICAub24oXCJzdGFydFwiLCByZXBlYXQpO1xuICB9KTtcbiAgXG4gIHJldHVybiB2aWV3O1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICBjb25zdCB2aWV3ID0gaHRtbGA8ZmlndXJlIHN0eWxlPVwidHJhbnNmb3JtOiBzY2FsZSgwLjcpO1wiPjxzdmcgd2lkdGg9JHtld2lkdGh9IGhlaWdodD1cIjU1MlwiPlxuXG4gICAgPGxpbmUgY2xhc3M9XCJlZGdlXCIgaWQ9XCJlMTJcIiB4MT1cIiR7ZXdpZHRoLzJ9XCIgeTE9XCI1MFwiIHgyPVwiJHtld2lkdGgvNH1cIiB5Mj1cIjE1MFwiIHN0cm9rZT1cImJsYWNrXCIgLz5cbiAgICA8bGluZSBjbGFzcz1cImVkZ2VcIiBpZD1cImUxM1wiIHgxPVwiJHtld2lkdGgvMn1cIiB5MT1cIjUwXCIgeDI9XCIkezMqZXdpZHRoLzR9XCIgeTI9XCIxNTBcIiBzdHJva2U9XCJibGFja1wiIC8+XG4gICAgPGxpbmUgY2xhc3M9XCJlZGdlXCIgaWQ9XCJlMjRcIiB4MT1cIiR7ZXdpZHRoLzR9XCIgeTE9XCIxNTBcIiB4Mj1cIiR7ZXdpZHRoLzh9XCIgeTI9XCIyNTBcIiBzdHJva2U9XCJibGFja1wiIC8+XG4gICAgPGxpbmUgY2xhc3M9XCJlZGdlXCIgaWQ9XCJlMjVcIiB4MT1cIiR7ZXdpZHRoLzR9XCIgeTE9XCIxNTBcIiB4Mj1cIiR7Mypld2lkdGgvOH1cIiB5Mj1cIjI1MFwiIHN0cm9rZT1cImJsYWNrXCIgLz5cbiAgICA8bGluZSBjbGFzcz1cImVkZ2VcIiBpZD1cImU1MTBcIiB4MT1cIiR7Mypld2lkdGgvOH1cIiB5MT1cIjI1MFwiIHgyPVwiJHs1KmV3aWR0aC8xNn1cIiB5Mj1cIjM1MFwiIHN0cm9rZT1cImJsYWNrXCIgLz5cbiAgICA8bGluZSBjbGFzcz1cImVkZ2VcIiBpZD1cImU1MTFcIiB4MT1cIiR7Mypld2lkdGgvOH1cIiB5MT1cIjI1MFwiIHgyPVwiJHs3KmV3aWR0aC8xNn1cIiB5Mj1cIjM1MFwiIHN0cm9rZT1cImJsYWNrXCIgLz5cblxuICAgIDxnIGNsYXNzPVwibm9kZVwiIGlkPVwibjFcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoJHtld2lkdGgvMn0sIDUwKVwiPlxuICAgICAgPGNpcmNsZSByPVwiMzVcIiBmaWxsPVwiJHtyb290fVwiIHN0cm9rZT1cImJsYWNrXCI+PC9jaXJjbGU+XG4gICAgICA8dGV4dCBjbGFzcz1cInZhbHVlXCIgZmlsbD1cIndoaXRlXCIgdGV4dC1hbmNob3I9XCJtaWRkbGVcIiBhbGlnbm1lbnQtYmFzZWxpbmU9XCJjZW50cmFsXCI+cm9vdDwvdGV4dD5cbiAgICAgIDx0ZXh0IGNsYXNzPVwiYmFsYW5jZVwiIGZpbGw9XCIjQzAwXCIgdHJhbnNmb3JtPVwidHJhbnNsYXRlKDMsIDI1KVwiIGFsaWdubWVudC1iYXNlbGluZT1cImhhbmdpbmdcIiBzdHlsZT1cImZvbnQtd2VpZ2h0OmJvbGRcIj4tMjwvdGV4dD5cbiAgICA8L2c+XG4gICAgPGcgY2xhc3M9XCJub2RlXCIgaWQ9XCJuMlwiIHRyYW5zZm9ybT1cInRyYW5zbGF0ZSgke2V3aWR0aC80fSwgMTUwKVwiPlxuICAgICAgPGNpcmNsZSByPVwiMzVcIiBmaWxsPVwiJHtwaXZvdH1cIiBzdHJva2U9XCJibGFja1wiPjwvY2lyY2xlPlxuICAgICAgPHRleHQgY2xhc3M9XCJ2YWx1ZVwiIGZpbGw9XCJ3aGl0ZVwiIHRleHQtYW5jaG9yPVwibWlkZGxlXCIgYWxpZ25tZW50LWJhc2VsaW5lPVwiY2VudHJhbFwiPnBpdm90PC90ZXh0PlxuICAgICAgPHRleHQgY2xhc3M9XCJiYWxhbmNlXCIgZmlsbD1cIiMwOTBcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoMywgMjUpXCIgYWxpZ25tZW50LWJhc2VsaW5lPVwiaGFuZ2luZ1wiPisxPC90ZXh0PlxuICAgIDwvZz5cbiAgICA8ZyBjbGFzcz1cIm5vZGVcIiBpZD1cIm4zXCIgdHJhbnNmb3JtPVwidHJhbnNsYXRlKCR7Mypld2lkdGgvNH0sIDE1MClcIj5cbiAgICAgIDxwb2x5Z29uIHBvaW50cz1cIjAsIDAgMjUsIDIwMCAtMjUsIDIwMFwiIGZpbGw9XCJ3aGl0ZVwiIHN0cm9rZT1cImJsYWNrXCIgLz5cbiAgICAgIDx0ZXh0IGZpbGw9XCJibGFja1wiIHk9XCIxMjVcIiB0ZXh0LWFuY2hvcj1cIm1pZGRsZVwiIGFsaWdubWVudC1iYXNlbGluZT1cImNlbnRyYWxcIj5oKzE8L3RleHQ+XG4gICAgPC9nPlxuICAgIDxnIGNsYXNzPVwibm9kZVwiIGlkPVwibjRcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoJHtld2lkdGgvOH0sIDI1MClcIj5cbiAgICAgIDxwb2x5Z29uIHBvaW50cz1cIjAsIDAgMjUsIDIwMCAtMjUsIDIwMFwiIGZpbGw9XCJ3aGl0ZVwiIHN0cm9rZT1cImJsYWNrXCIgLz5cbiAgICAgIDx0ZXh0IGZpbGw9XCJibGFja1wiIHk9XCIxMjVcIiB0ZXh0LWFuY2hvcj1cIm1pZGRsZVwiIGFsaWdubWVudC1iYXNlbGluZT1cImNlbnRyYWxcIj5oKzE8L3RleHQ+XG4gICAgPC9nPlxuICAgIDxnIGNsYXNzPVwibm9kZVwiIGlkPVwibjVcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoJHszKmV3aWR0aC84fSwgMjUwKVwiPlxuICAgICAgPGNpcmNsZSByPVwiMzVcIiBmaWxsPVwiJHtzZWNvbmRhcnl9XCIgc3Ryb2tlPVwiYmxhY2tcIj48L2NpcmNsZT5cbiAgICAgIDx0ZXh0IGNsYXNzPVwidmFsdWVcIiBmaWxsPVwid2hpdGVcIiB0ZXh0LWFuY2hvcj1cIm1pZGRsZVwiIGFsaWdubWVudC1iYXNlbGluZT1cImNlbnRyYWxcIj5zZWM8L3RleHQ+XG4gICAgICA8dGV4dCBjbGFzcz1cImJhbGFuY2VcIiBmaWxsPVwiI0MwMFwiIHRyYW5zZm9ybT1cInRyYW5zbGF0ZSgxNSwgMjApXCIgYWxpZ25tZW50LWJhc2VsaW5lPVwiaGFuZ2luZ1wiPi0xPC90ZXh0PlxuICAgIDwvZz5cbiAgICA8ZyBjbGFzcz1cIm5vZGVcIiBpZD1cIm4xMFwiIHRyYW5zZm9ybT1cInRyYW5zbGF0ZSgkezUqZXdpZHRoLzE2fSwgMzUwKVwiPlxuICAgICAgPHBvbHlnb24gcG9pbnRzPVwiMCwgMCAyNSwgMTAwIC0yNSwgMTAwXCIgZmlsbD1cIndoaXRlXCIgc3Ryb2tlPVwiYmxhY2tcIiAvPlxuICAgICAgPHRleHQgZmlsbD1cImJsYWNrXCIgeT1cIjUwXCIgdGV4dC1hbmNob3I9XCJtaWRkbGVcIiBhbGlnbm1lbnQtYmFzZWxpbmU9XCJjZW50cmFsXCI+aDwvdGV4dD5cbiAgICAgIDxsaW5lIHgxPVwiMFwiIHkxPVwiMTAwXCIgeDI9XCIwXCIgeTI9XCIxNzVcIiBzdHJva2U9XCJibGFja1wiIHN0cm9rZS1kYXNoYXJyYXk9XCI0XCIgLz5cbiAgICAgIDxjaXJjbGUgY3k9XCIxNzVcIiByPVwiMTBcIiBzdHJva2UtZGFzaGFycmF5PVwiNFwiIGZpbGw9XCJ3aGl0ZVwiIHN0cm9rZT1cImJsYWNrXCI+PC9jaXJjbGU+XG4gICAgPC9nPlxuICAgIDxnIGNsYXNzPVwibm9kZVwiIGlkPVwibjExXCIgdHJhbnNmb3JtPVwidHJhbnNsYXRlKCR7Nypld2lkdGgvMTZ9LCAzNTApXCI+XG4gICAgICA8cG9seWdvbiBwb2ludHM9XCIwLCAwIDI1LCAxMDAgLTI1LCAxMDBcIiBmaWxsPVwid2hpdGVcIiBzdHJva2U9XCJibGFja1wiIC8+XG4gICAgICA8dGV4dCBmaWxsPVwiYmxhY2tcIiB5PVwiNTBcIiB0ZXh0LWFuY2hvcj1cIm1pZGRsZVwiIGFsaWdubWVudC1iYXNlbGluZT1cImNlbnRyYWxcIj5oPC90ZXh0PlxuICAgICAgPGxpbmUgeDE9XCIwXCIgeTE9XCIxMDBcIiB4Mj1cIjBcIiB5Mj1cIjE3NVwiIHN0cm9rZT1cImJsYWNrXCIgc3Ryb2tlLWRhc2hhcnJheT1cIjRcIiB2aXNpYmlsaXR5PVwiaGlkZGVuXCIgLz5cbiAgICAgIDxjaXJjbGUgY3k9XCIxNzVcIiByPVwiMTBcIiBzdHJva2UtZGFzaGFycmF5PVwiNFwiIGZpbGw9XCJ3aGl0ZVwiIHN0cm9rZT1cImJsYWNrXCIgdmlzaWJpbGl0eT1cImhpZGRlblwiID48L2NpcmNsZT5cbiAgICA8L2c+XG4gPC9zdmc+XG4gIDwvZmlndXJlPmA7XG4gIFxuICBjb25zdCB0cmVlX3ZpZXcgPSBkMy5zZWxlY3Qodmlldyk7XG4gIHZhciB0ID0gZDMudHJhbnNpdGlvbigpO1xuICAgIFxuICB0cmVlX3ZpZXcuc2VsZWN0KFwiI2UxMlwiKS50cmFuc2l0aW9uKHQpXG4gICAgLmRlbGF5KDEwMDApXG4gICAgLm9uKFwic3RhcnRcIiwgZnVuY3Rpb24gcmVwZWF0KCkge1xuICAgICAgZDMuYWN0aXZlKHRoaXMpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kdXJhdGlvbihkdXIpXG4gICAgICAgICAgLmF0dHIoXCJ4MVwiLCAzKmV3aWR0aC80KVxuICAgICAgICAgIC5hdHRyKFwieTFcIiwgMTUwKVxuICAgICAgICAgIC5hdHRyKFwieDJcIiwgZXdpZHRoLzIpXG4gICAgICAgICAgLmF0dHIoXCJ5MlwiLCA1MClcbiAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLmR1cmF0aW9uKDApXG4gICAgICAgICAgLmF0dHIoXCJ4MVwiLCBld2lkdGgvMilcbiAgICAgICAgICAuYXR0cihcInkxXCIsIDUwKVxuICAgICAgICAgIC5hdHRyKFwieDJcIiwgZXdpZHRoLzQpIFxuICAgICAgICAgIC5hdHRyKFwieTJcIiwgMTUwKVxuICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmRlbGF5KGR1cilcbiAgICAgICAgICAub24oXCJzdGFydFwiLCByZXBlYXQpO1xuICB9KTtcbiAgdHJlZV92aWV3LnNlbGVjdChcIiNlMTNcIikudHJhbnNpdGlvbih0KVxuICAgIC5kZWxheSgxMDAwKVxuICAgIC5vbihcInN0YXJ0XCIsIGZ1bmN0aW9uIHJlcGVhdCgpIHtcbiAgICAgIGQzLmFjdGl2ZSh0aGlzKVxuICAgICAgICAgIC5kdXJhdGlvbihkdXIpXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZHVyYXRpb24oZHVyKVxuICAgICAgICAgIC5hdHRyKFwieDFcIiwgMypld2lkdGgvNClcbiAgICAgICAgICAuYXR0cihcInkxXCIsIDE1MClcbiAgICAgICAgICAuYXR0cihcIngyXCIsIDcqZXdpZHRoLzgpXG4gICAgICAgICAgLmF0dHIoXCJ5MlwiLCAyNTApXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5kdXJhdGlvbigwKVxuICAgICAgICAgIC5hdHRyKFwieDFcIiwgZXdpZHRoLzIpXG4gICAgICAgICAgLmF0dHIoXCJ5MVwiLCA1MClcbiAgICAgICAgICAuYXR0cihcIngyXCIsIDMqZXdpZHRoLzQpXG4gICAgICAgICAgLmF0dHIoXCJ5MlwiLCAxNTApXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5vbihcInN0YXJ0XCIsIHJlcGVhdCk7XG4gIH0pO1xuICB0cmVlX3ZpZXcuc2VsZWN0KFwiI2UyNFwiKS50cmFuc2l0aW9uKHQpXG4gICAgLmRlbGF5KDEwMDApXG4gICAgLm9uKFwic3RhcnRcIiwgZnVuY3Rpb24gcmVwZWF0KCkge1xuICAgICAgZDMuYWN0aXZlKHRoaXMpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgICAuYXR0cihcIngxXCIsIGV3aWR0aC84KVxuICAgICAgICAgIC5hdHRyKFwieTFcIiwgMjUwKVxuICAgICAgICAgIC5hdHRyKFwieDJcIiwgZXdpZHRoLzE2KVxuICAgICAgICAgIC5hdHRyKFwieTJcIiwgMzUwKVxuICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgICAuYXR0cihcIngxXCIsIGV3aWR0aC80KVxuICAgICAgICAgIC5hdHRyKFwieTFcIiwgMTUwKVxuICAgICAgICAgIC5hdHRyKFwieDJcIiwgZXdpZHRoLzgpXG4gICAgICAgICAgLmF0dHIoXCJ5MlwiLCAyNTApXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5kdXJhdGlvbigwKVxuICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmRlbGF5KGR1cilcbiAgICAgICAgICAub24oXCJzdGFydFwiLCByZXBlYXQpO1xuICB9KTtcbiAgdHJlZV92aWV3LnNlbGVjdChcIiNlMjVcIikudHJhbnNpdGlvbih0KVxuICAgIC5kZWxheSgxMDAwKVxuICAgIC5vbihcInN0YXJ0XCIsIGZ1bmN0aW9uIHJlcGVhdCgpIHtcbiAgICAgIGQzLmFjdGl2ZSh0aGlzKVxuICAgICAgICAgIC5kdXJhdGlvbihkdXIpXG4gICAgICAgICAgLmF0dHIoXCJ4MVwiLCBld2lkdGgvOClcbiAgICAgICAgICAuYXR0cihcInkxXCIsIDI1MClcbiAgICAgICAgICAuYXR0cihcIngyXCIsIGV3aWR0aC80KVxuICAgICAgICAgIC5hdHRyKFwieTJcIiwgMTUwKVxuICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgICAuYXR0cihcIngxXCIsIGV3aWR0aC80KVxuICAgICAgICAgIC5hdHRyKFwieTFcIiwgMTUwKVxuICAgICAgICAgIC5hdHRyKFwieDJcIiwgZXdpZHRoLzIpXG4gICAgICAgICAgLmF0dHIoXCJ5MlwiLCA1MClcbiAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLmR1cmF0aW9uKDApXG4gICAgICAgICAgLmF0dHIoXCJ4MVwiLCBld2lkdGgvNClcbiAgICAgICAgICAuYXR0cihcInkxXCIsIDE1MClcbiAgICAgICAgICAuYXR0cihcIngyXCIsIDMqZXdpZHRoLzgpXG4gICAgICAgICAgLmF0dHIoXCJ5MlwiLCAyNTApXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5vbihcInN0YXJ0XCIsIHJlcGVhdCk7XG4gIH0pO1xuICB0cmVlX3ZpZXcuc2VsZWN0KFwiI2U1MTBcIikudHJhbnNpdGlvbih0KVxuICAgIC5kZWxheSgxMDAwKVxuICAgIC5vbihcInN0YXJ0XCIsIGZ1bmN0aW9uIHJlcGVhdCgpIHtcbiAgICAgIGQzLmFjdGl2ZSh0aGlzKVxuICAgICAgICAgIC5kdXJhdGlvbihkdXIpXG4gICAgICAgICAgLmF0dHIoXCJ4MVwiLCBld2lkdGgvOClcbiAgICAgICAgICAuYXR0cihcInkxXCIsIDI1MClcbiAgICAgICAgICAuYXR0cihcIngyXCIsIDMqZXdpZHRoLzE2KVxuICAgICAgICAgIC5hdHRyKFwieTJcIiwgMzUwKVxuICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgICAuYXR0cihcIngxXCIsIGV3aWR0aC80KVxuICAgICAgICAgIC5hdHRyKFwieTFcIiwgMTUwKVxuICAgICAgICAgIC5hdHRyKFwieDJcIiwgMypld2lkdGgvOClcbiAgICAgICAgICAuYXR0cihcInkyXCIsIDI1MClcbiAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLmR1cmF0aW9uKDApXG4gICAgICAgICAgLmF0dHIoXCJ4MVwiLCAzKmV3aWR0aC84KVxuICAgICAgICAgIC5hdHRyKFwieTFcIiwgMjUwKVxuICAgICAgICAgIC5hdHRyKFwieDJcIiwgNSpld2lkdGgvMTYpXG4gICAgICAgICAgLmF0dHIoXCJ5MlwiLCAzNTApXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5vbihcInN0YXJ0XCIsIHJlcGVhdCk7XG4gIH0pO1xuICB0cmVlX3ZpZXcuc2VsZWN0KFwiI2U1MTFcIikudHJhbnNpdGlvbih0KVxuICAgIC5kZWxheSgxMDAwKVxuICAgIC5vbihcInN0YXJ0XCIsIGZ1bmN0aW9uIHJlcGVhdCgpIHtcbiAgICAgIGQzLmFjdGl2ZSh0aGlzKVxuICAgICAgICAgIC5kdXJhdGlvbihkdXIpXG4gICAgICAgICAgLmF0dHIoXCJ4MVwiLCBld2lkdGgvNClcbiAgICAgICAgICAuYXR0cihcInkxXCIsIDE1MClcbiAgICAgICAgICAuYXR0cihcIngyXCIsIDMqZXdpZHRoLzgpXG4gICAgICAgICAgLmF0dHIoXCJ5MlwiLCAyNTApXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZHVyYXRpb24oZHVyKVxuICAgICAgICAgIC5hdHRyKFwieDFcIiwgMypld2lkdGgvNClcbiAgICAgICAgICAuYXR0cihcInkxXCIsIDE1MClcbiAgICAgICAgICAuYXR0cihcIngyXCIsIDUqZXdpZHRoLzgpXG4gICAgICAgICAgLmF0dHIoXCJ5MlwiLCAyNTApXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5kdXJhdGlvbigwKVxuICAgICAgICAgIC5hdHRyKFwieDFcIiwgMypld2lkdGgvOClcbiAgICAgICAgICAuYXR0cihcInkxXCIsIDI1MClcbiAgICAgICAgICAuYXR0cihcIngyXCIsIDcqZXdpZHRoLzE2KVxuICAgICAgICAgIC5hdHRyKFwieTJcIiwgMzUwKVxuICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmRlbGF5KGR1cilcbiAgICAgICAgICAub24oXCJzdGFydFwiLCByZXBlYXQpO1xuICB9KTtcblxuICBcbiAgdHJlZV92aWV3LnNlbGVjdChcIiNuMVwiKS50cmFuc2l0aW9uKHQpXG4gICAgLmRlbGF5KDEwMDApXG4gICAgLm9uKFwic3RhcnRcIiwgZnVuY3Rpb24gcmVwZWF0KCkge1xuICAgICAgZDMuYWN0aXZlKHRoaXMpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZHVyYXRpb24oZHVyKVxuICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgKDMqZXdpZHRoLzQpICsgXCIsIDE1MClcIilcbiAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5kdXJhdGlvbigwKVxuICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgKGV3aWR0aC8yKSArIFwiLCA1MClcIilcbiAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLm9uKFwic3RhcnRcIiwgcmVwZWF0KTtcbiAgfSk7XG4gIHRyZWVfdmlldy5zZWxlY3QoXCIjbjE+LmJhbGFuY2VcIikudHJhbnNpdGlvbih0KVxuICAgIC5kZWxheSgxMDAwKVxuICAgIC5vbihcInN0YXJ0XCIsIGZ1bmN0aW9uIHJlcGVhdCgpIHtcbiAgICAgIGQzLmFjdGl2ZSh0aGlzKVxuICAgICAgICAgIC5kdXJhdGlvbihkdXIpXG4gICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgICAudGV4dFR3ZWVuKCgpID0+ICgodCkgPT4gdCA8PSAwLjUgPyBcIi0yXCIgOiBcIisxXCIpKVxuICAgICAgICAgIC5zdHlsZShcImZpbGxcIiwgXCIjMDkwXCIpXG4gICAgICAgICAgLnN0eWxlVHdlZW4oXCJmb250LXdlaWdodFwiLCAoKSA9PiAoKHQpID0+IHQgPD0gMC41ID8gXCJib2xkXCIgOlwibm9ybWFsXCIpKVxuICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLmR1cmF0aW9uKDApXG4gICAgICAgICAgLnRleHQoLTIpXG4gICAgICAgICAgLnN0eWxlKFwiZmlsbFwiLCBcIiNjMDBcIilcbiAgICAgICAgICAuc3R5bGUoXCJmb250LXdlaWdodFwiLCBcImJvbGRcIilcbiAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLm9uKFwic3RhcnRcIiwgcmVwZWF0KTtcbiAgfSk7XG4gIFxuICB0cmVlX3ZpZXcuc2VsZWN0KFwiI24yXCIpLnRyYW5zaXRpb24odClcbiAgICAuZGVsYXkoMTAwMClcbiAgICAub24oXCJzdGFydFwiLCBmdW5jdGlvbiByZXBlYXQoKSB7XG4gICAgICBkMy5hY3RpdmUodGhpcylcbiAgICAgICAgICAuZHVyYXRpb24oZHVyKVxuICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgKGV3aWR0aC84KSArIFwiLCAyNTApXCIpXG4gICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIChld2lkdGgvNCkgKyBcIiwgMTUwKVwiKVxuICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLmR1cmF0aW9uKDApXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5vbihcInN0YXJ0XCIsIHJlcGVhdCk7XG4gIH0pO1xuICB0cmVlX3ZpZXcuc2VsZWN0KFwiI24yPi5iYWxhbmNlXCIpLnRyYW5zaXRpb24odClcbiAgICAuZGVsYXkoMTAwMClcbiAgICAub24oXCJzdGFydFwiLCBmdW5jdGlvbiByZXBlYXQoKSB7XG4gICAgICBkMy5hY3RpdmUodGhpcylcbiAgICAgICAgICAuZHVyYXRpb24oZHVyKVxuICAgICAgICAgIC50ZXh0VHdlZW4oKCkgPT4gKCh0KSA9PiB0IDw9IDAuNSA/IFwiKzFcIiA6IFwiMFwiKSlcbiAgICAgICAgICAuc3R5bGUoXCJmaWxsXCIsIFwiYmxhY2tcIilcbiAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZSgxNSwyMClcIilcbiAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZHVyYXRpb24oZHVyKVxuICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKDMsMjUpXCIpXG4gICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmRlbGF5KGR1cilcbiAgICAgICAgICAuZHVyYXRpb24oMClcbiAgICAgICAgICAudGV4dChcIisxXCIpXG4gICAgICAgICAgLnN0eWxlKFwiZmlsbFwiLCBcIiMwOTBcIilcbiAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLm9uKFwic3RhcnRcIiwgcmVwZWF0KTtcbiAgfSk7XG5cbiAgdHJlZV92aWV3LnNlbGVjdChcIiNuM1wiKS50cmFuc2l0aW9uKHQpXG4gICAgLmRlbGF5KDEwMDApXG4gICAgLm9uKFwic3RhcnRcIiwgZnVuY3Rpb24gcmVwZWF0KCkge1xuICAgICAgZDMuYWN0aXZlKHRoaXMpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZHVyYXRpb24oZHVyKVxuICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgKDcqZXdpZHRoLzgpICsgXCIsIDI1MClcIilcbiAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5kdXJhdGlvbigwKVxuICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgKDMqZXdpZHRoLzQpICsgXCIsIDE1MClcIilcbiAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLm9uKFwic3RhcnRcIiwgcmVwZWF0KTtcbiAgfSk7XG5cbiAgdHJlZV92aWV3LnNlbGVjdChcIiNuNFwiKS50cmFuc2l0aW9uKHQpXG4gICAgLmRlbGF5KDEwMDApXG4gICAgLm9uKFwic3RhcnRcIiwgZnVuY3Rpb24gcmVwZWF0KCkge1xuICAgICAgZDMuYWN0aXZlKHRoaXMpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIChld2lkdGgvMTYpICsgXCIsIDM1MClcIilcbiAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZHVyYXRpb24oZHVyKVxuICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgKGV3aWR0aC84KSArIFwiLCAyNTApXCIpXG4gICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmRlbGF5KGR1cilcbiAgICAgICAgICAuZHVyYXRpb24oMClcbiAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLm9uKFwic3RhcnRcIiwgcmVwZWF0KTtcbiAgfSk7XG5cbiAgdHJlZV92aWV3LnNlbGVjdChcIiNuNVwiKS50cmFuc2l0aW9uKHQpXG4gICAgLmRlbGF5KDEwMDApXG4gICAgLm9uKFwic3RhcnRcIiwgZnVuY3Rpb24gcmVwZWF0KCkge1xuICAgICAgZDMuYWN0aXZlKHRoaXMpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIChld2lkdGgvNCkgKyBcIiwgMTUwKVwiKVxuICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kdXJhdGlvbihkdXIpXG4gICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyAoZXdpZHRoLzIpICsgXCIsIDUwKVwiKVxuICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLmR1cmF0aW9uKDApXG4gICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyAoMypld2lkdGgvOCkgKyBcIiwgMjUwKVwiKVxuICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmRlbGF5KGR1cilcbiAgICAgICAgICAub24oXCJzdGFydFwiLCByZXBlYXQpO1xuICB9KTtcbiAgdHJlZV92aWV3LnNlbGVjdChcIiNuNT4uYmFsYW5jZVwiKS50cmFuc2l0aW9uKHQpXG4gICAgLmRlbGF5KDEwMDApXG4gICAgLm9uKFwic3RhcnRcIiwgZnVuY3Rpb24gcmVwZWF0KCkge1xuICAgICAgZDMuYWN0aXZlKHRoaXMpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZSgzLCAyNSlcIilcbiAgICAgICAgICAudGV4dFR3ZWVuKCgpID0+ICgodCkgPT4gdCA8PSAwLjUgPyBcIi0xXCIgOiBcIi0yXCIpKVxuICAgICAgICAgIC5zdHlsZVR3ZWVuKFwiZm9udC13ZWlnaHRcIiwgKCkgPT4gKCh0KSA9PiB0IDw9IDAuNSA/IFwibm9ybWFsXCIgOlwiYm9sZFwiKSlcbiAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kdXJhdGlvbihkdXIpXG4gICAgICAgICAgLnRleHRUd2VlbigoKSA9PiAoKHQpID0+IHQgPD0gMC41ID8gXCItMlwiIDogXCIwXCIpKVxuICAgICAgICAgIC5zdHlsZShcImZpbGxcIiwgXCJibGFja1wiKVxuICAgICAgICAgIC5zdHlsZVR3ZWVuKFwiZm9udC13ZWlnaHRcIiwgKCkgPT4gKCh0KSA9PiB0IDw9IDAuNSA/IFwiYm9sZFwiIDpcIm5vcm1hbFwiKSlcbiAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5kdXJhdGlvbigwKVxuICAgICAgICAgIC50ZXh0KC0xKVxuICAgICAgICAgIC5zdHlsZShcImZpbGxcIiwgXCIjYzAwXCIpXG4gICAgICAgICAgLnN0eWxlKFwiZm9udC13ZWlnaHRcIiwgXCJub3JtYWxcIilcbiAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZSgxNSwgMjApXCIpXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5vbihcInN0YXJ0XCIsIHJlcGVhdCk7XG4gICAgfSk7XG5cbiAgICB0cmVlX3ZpZXcuc2VsZWN0KFwiI24xMFwiKS50cmFuc2l0aW9uKHQpXG4gICAgLmRlbGF5KDEwMDApXG4gICAgLm9uKFwic3RhcnRcIiwgZnVuY3Rpb24gcmVwZWF0KCkge1xuICAgICAgZDMuYWN0aXZlKHRoaXMpXG4gICAgICAgICAgLmR1cmF0aW9uKGR1cilcbiAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArICgzKmV3aWR0aC8xNikgKyBcIiwgMzUwKVwiKVxuICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kdXJhdGlvbihkdXIpXG4gICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyAoMypld2lkdGgvOCkgKyBcIiwgMjUwKVwiKVxuICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLmR1cmF0aW9uKDApXG4gICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyAoNSpld2lkdGgvMTYpICsgXCIsIDM1MClcIilcbiAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgIC5kZWxheShkdXIpXG4gICAgICAgICAgLm9uKFwic3RhcnRcIiwgcmVwZWF0KTtcbiAgICB9KTtcblxuICAgIHRyZWVfdmlldy5zZWxlY3QoXCIjbjExXCIpLnRyYW5zaXRpb24odClcbiAgICAuZGVsYXkoMTAwMClcbiAgICAub24oXCJzdGFydFwiLCBmdW5jdGlvbiByZXBlYXQoKSB7XG4gICAgICBkMy5hY3RpdmUodGhpcylcbiAgICAgICAgICAuZHVyYXRpb24oZHVyKVxuICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgKDMqZXdpZHRoLzgpICsgXCIsIDI1MClcIilcbiAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZHVyYXRpb24oZHVyKVxuICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgKDUqZXdpZHRoLzgpICsgXCIsIDI1MClcIilcbiAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5kdXJhdGlvbigwKVxuICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgKDcqZXdpZHRoLzE2KSArIFwiLCAzNTApXCIpXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAuZGVsYXkoZHVyKVxuICAgICAgICAgIC5vbihcInN0YXJ0XCIsIHJlcGVhdCk7XG4gICAgIH0pO1xuXG4gIHJldHVybiB2aWV3O1xufVxuIn1dfQ==
    </script>
    <script type="module">
    if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
    window._ojs.paths.runtimeToDoc = "../../..";
    window._ojs.paths.runtimeToRoot = "../../..";
    window._ojs.paths.docToRoot = "";
    window._ojs.selfContained = false;
    window._ojs.runtime.interpretFromScriptTags();
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
          let selectedAnnoteEl;
          const selectorForAnnotation = ( cell, annotation) => {
            let cellAttr = 'data-code-cell="' + cell + '"';
            let lineAttr = 'data-code-annotation="' +  annotation + '"';
            const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
            return selector;
          }
          const selectCodeLines = (annoteEl) => {
            const doc = window.document;
            const targetCell = annoteEl.getAttribute("data-target-cell");
            const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
            const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            const lines = annoteSpan.getAttribute("data-code-lines").split(",");
            const lineIds = lines.map((line) => {
              return targetCell + "-" + line;
            })
            let top = null;
            let height = null;
            let parent = null;
            if (lineIds.length > 0) {
                //compute the position of the single el (top and bottom and make a div)
                const el = window.document.getElementById(lineIds[0]);
                top = el.offsetTop;
                height = el.offsetHeight;
                parent = el.parentElement.parentElement;
              if (lineIds.length > 1) {
                const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                height = bottom - top;
              }
              if (top !== null && height !== null && parent !== null) {
                // cook up a div (if necessary) and position it 
                let div = window.document.getElementById("code-annotation-line-highlight");
                if (div === null) {
                  div = window.document.createElement("div");
                  div.setAttribute("id", "code-annotation-line-highlight");
                  div.style.position = 'absolute';
                  parent.appendChild(div);
                }
                div.style.top = top - 2 + "px";
                div.style.height = height + 4 + "px";
                div.style.left = 0;
                let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                if (gutterDiv === null) {
                  gutterDiv = window.document.createElement("div");
                  gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                  gutterDiv.style.position = 'absolute';
                  const codeCell = window.document.getElementById(targetCell);
                  const gutter = codeCell.querySelector('.code-annotation-gutter');
                  gutter.appendChild(gutterDiv);
                }
                gutterDiv.style.top = top - 2 + "px";
                gutterDiv.style.height = height + 4 + "px";
              }
              selectedAnnoteEl = annoteEl;
            }
          };
          const unselectCodeLines = () => {
            const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
            elementsIds.forEach((elId) => {
              const div = window.document.getElementById(elId);
              if (div) {
                div.remove();
              }
            });
            selectedAnnoteEl = undefined;
          };
            // Handle positioning of the toggle
        window.addEventListener(
          "resize",
          throttle(() => {
            elRect = undefined;
            if (selectedAnnoteEl) {
              selectCodeLines(selectedAnnoteEl);
            }
          }, 10)
        );
        function throttle(fn, ms) {
        let throttle = false;
        let timer;
          return (...args) => {
            if(!throttle) { // first call gets through
                fn.apply(this, args);
                throttle = true;
            } else { // all the others get throttled
                if(timer) clearTimeout(timer); // cancel #2
                timer = setTimeout(() => {
                  fn.apply(this, args);
                  timer = throttle = false;
                }, ms);
            }
          };
        }
          const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
          for (let i=0; i<annoteTargets.length; i++) {
            const annoteTarget = annoteTargets[i];
            const targetCell = annoteTarget.getAttribute("data-target-cell");
            const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
            const contentFn = () => {
              const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              if (content) {
                const tipContent = content.cloneNode(true);
                tipContent.classList.add("code-annotation-tip-content");
                return tipContent.outerHTML;
              }
            }
            const config = {
              allowHTML: true,
              content: contentFn,
              onShow: (instance) => {
                selectCodeLines(instance.reference);
                instance.reference.classList.add('code-annotation-active');
                window.tippy.hideAll();
              },
              onHide: (instance) => {
                unselectCodeLines();
                instance.reference.classList.remove('code-annotation-active');
              },
              maxWidth: 300,
              delay: [50, 0],
              duration: [200, 0],
              offset: [5, 10],
              arrow: true,
              appendTo: function(el) {
                return el.parentElement.parentElement.parentElement;
              },
              interactive: true,
              interactiveBorder: 10,
              theme: 'light-border',
              placement: 'right',
              popperOptions: {
                modifiers: [
                {
                  name: 'flip',
                  options: {
                    flipVariations: false, // true by default
                    allowedAutoPlacements: ['right'],
                    fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                  },
                },
                {
                  name: 'preventOverflow',
                  options: {
                    mainAxis: false,
                    altAxis: false
                  }
                }
                ]        
              }      
            };
            window.tippy(annoteTarget, config); 
          }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
        <script type="text/javascript">
        (function(d) {
          d.querySelectorAll(".pseudocode-container").forEach(function(el) {
            let pseudocodeOptions = {
              indentSize: el.dataset.indentSize || "1.2em",
              commentDelimiter: el.dataset.commentDelimiter || "//",
              lineNumber: el.dataset.lineNumber === "true" ? true : false,
              lineNumberPunc: el.dataset.lineNumberPunc || ":",
              noEnd: el.dataset.noEnd === "true" ? true : false,
              titlePrefix: el.dataset.captionPrefix || "Algorithm"
            };
            pseudocode.renderElement(el.querySelector(".pseudocode"), pseudocodeOptions);
          });
        })(document);
        (function(d) {
          d.querySelectorAll(".pseudocode-container").forEach(function(el) {
            let captionSpan = el.querySelector(".ps-root > .ps-algorithm > .ps-line > .ps-keyword")
            if (captionSpan !== null) {
              let captionPrefix = el.dataset.captionPrefix + " ";
              let captionNumber = "";
              if (el.dataset.pseudocodeNumber) {
                captionNumber = el.dataset.pseudocodeNumber + " ";
                if (el.dataset.chapterLevel) {
                  captionNumber = el.dataset.chapterLevel + "." + captionNumber;
                }
              }
              captionSpan.innerHTML = captionPrefix + captionNumber;
            }
          });
        })(document);
        </script>
      
    

</body></html>